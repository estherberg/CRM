{"ast":null,"code":"import _slicedToArray from \"C:/Users/esthe/OneDrive/Desktop/Projet Code/Ouieqare-MERN - Copie/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\esthe\\\\OneDrive\\\\Desktop\\\\Projet Code\\\\Ouieqare-MERN - Copie\\\\front-end\\\\src\\\\views\\\\examples\\\\Corbeille.js\",\n    _s = $RefreshSig$();\n\nimport { useHistory } from \"react-router-dom\";\nimport React, { useState, useEffect } from \"react\";\nimport { ToastContainer, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport { Button, CardBody, Card, CardHeader, Container, Row } from \"reactstrap\";\nimport BootstrapTable from \"react-bootstrap-table-next\";\nimport paginationFactory from \"react-bootstrap-table2-paginator\";\nimport ToolkitProvider, { Search } from \"react-bootstrap-table2-toolkit\";\nimport Header from \"components/Headers/Header.js\";\nimport 'react-bootstrap-table-next/dist/react-bootstrap-table2.min.css';\n\nvar Corbeille = function Corbeille() {\n  _s();\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      clients = _useState2[0],\n      setClients = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      totalClients = _useState4[0],\n      setTotalClients = _useState4[1];\n\n  var history = useHistory();\n  var SearchBar = Search.SearchBar;\n  useEffect(function () {\n    fetchDeletedClients();\n  }, []);\n\n  var fetchDeletedClients = function fetchDeletedClients() {\n    var token = localStorage.getItem('token');\n\n    if (!token) {\n      console.error('Token not found in localStorage');\n      return;\n    }\n\n    var cleanToken = token.trim();\n    var formattedToken = cleanToken.replace('JWT ', '');\n    console.log(\"Formatted Token from localStorage:\", formattedToken);\n    fetch('http://localhost:5100/api/clients/deleted', {\n      headers: {\n        'Authorization': \"Bearer \".concat(formattedToken)\n      }\n    }).then(function (response) {\n      if (!response.ok) {\n        throw new Error(\"HTTP status \".concat(response.status));\n      }\n\n      return response.json();\n    }).then(function (data) {\n      console.log('Deleted clients fetched:', data);\n      setClients(data); // Ceci met à jour l'état avec les données récupérées\n\n      setTotalClients(data.length);\n    }).catch(function (err) {\n      console.error('Error fetching clients:', err.message);\n    });\n  }; // Définition des colonnes du tableau\n\n\n  var columns = [{\n    dataField: \"_id\",\n    text: \"ID\",\n    hidden: true\n  }, {\n    dataField: \"nom\",\n    text: \"Nom\"\n  }, {\n    dataField: \"prenom\",\n    text: \"Prénom\"\n  }, {\n    dataField: \"email\",\n    text: \"Email\"\n  }, {\n    dataField: \"actions\",\n    text: \"Actions\",\n    formatter: function formatter(cellContent, row) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        color: \"success\",\n        size: \"sm\",\n        onClick: function onClick() {\n          return restoreClient(row._id);\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 11\n        }\n      }, \"Restaurer\"), ' ', /*#__PURE__*/React.createElement(Button, {\n        color: \"danger\",\n        size: \"sm\",\n        onClick: function onClick() {\n          return deleteClient(row._id);\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fas fa-trash\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 13\n        }\n      })));\n    }\n  }];\n\n  var restoreClient = function restoreClient(clientId) {\n    var token = localStorage.getItem('token');\n\n    if (!token) {\n      console.error('Token not found in localStorage');\n      return;\n    }\n\n    var cleanToken = token.trim();\n    var formattedToken = cleanToken.replace('JWT ', '');\n    fetch(\"http://localhost:5100/api/clients/restore/\".concat(clientId), {\n      method: 'PUT',\n      headers: {\n        'Authorization': \"Bearer \".concat(formattedToken),\n        'Content-Type': 'application/json'\n      }\n    }).then(function (response) {\n      if (!response.ok) {\n        throw new Error(\"HTTP status \".concat(response.status));\n      }\n\n      return response.json();\n    }).then(function (data) {\n      if (data.success) {\n        setTotalClients(function (prevTotal) {\n          return prevTotal - 1;\n        });\n        toast.success(\"Client restored successfully!\");\n        setClients(function (currentClients) {\n          return currentClients.filter(function (client) {\n            return client._id !== clientId;\n          });\n        });\n      } else {\n        throw new Error(data.message);\n      }\n    }).catch(function (error) {\n      console.error('Error:', error);\n      toast.error(\"Error: \".concat(error.message));\n    });\n  };\n\n  var deleteClient = function deleteClient(clientId) {\n    var token = localStorage.getItem('token');\n\n    if (!token) {\n      console.error('Token not found in localStorage');\n      return;\n    }\n\n    var cleanToken = token.trim();\n    var formattedToken = cleanToken.replace('JWT ', '');\n    fetch(\"http://localhost:5100/api/clients/deletedef/\".concat(clientId), {\n      method: 'DELETE',\n      headers: {\n        'Authorization': \"Bearer \".concat(formattedToken),\n        'Content-Type': 'application/json'\n      }\n    }).then(function (response) {\n      if (!response.ok) {\n        throw new Error(\"HTTP status \".concat(response.status));\n      }\n\n      return response.json();\n    }).then(function (data) {\n      if (data.success) {\n        toast.success(\"Client supprimé avec succès!\");\n        setTotalClients(function (prevTotal) {\n          return prevTotal - 1;\n        });\n        setClients(function (currentClients) {\n          return currentClients.filter(function (client) {\n            return client._id !== clientId;\n          });\n        });\n      } else {\n        throw new Error(data.message);\n      }\n    }).catch(function (error) {\n      console.error('Error:', error);\n      toast.error(\"Error: \".concat(error.message));\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Header, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(Container, {\n    className: \"mt--7\",\n    fluid: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(ToastContainer, {\n    position: \"bottom-right\",\n    autoClose: 5000,\n    hideProgressBar: false,\n    newestOnTop: false,\n    closeOnClick: true,\n    rtl: false,\n    pauseOnFocusLoss: true,\n    draggable: true,\n    pauseOnHover: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Row, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Card, {\n    className: \"shadow\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(CardHeader, {\n    className: \"border-0\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    className: \"mb-0\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 15\n    }\n  }, \"Corbeille (Total : \", totalClients, \")\")), /*#__PURE__*/React.createElement(CardBody, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(ToolkitProvider, {\n    keyField: \"_id\",\n    data: clients,\n    columns: columns,\n    search: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 13\n    }\n  }, function (props) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(SearchBar, Object.assign({}, props.searchProps, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 23\n      }\n    })), /*#__PURE__*/React.createElement(BootstrapTable, Object.assign({}, props.baseProps, {\n      bootstrap4: true,\n      pagination: paginationFactory(),\n      noDataIndication: \"Aucun client supprim\\xE9 trouv\\xE9\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 23\n      }\n    })));\n  })))))));\n};\n\n_s(Corbeille, \"DkPoF+uLQ2O3T12Ad/LN4V+p48w=\", false, function () {\n  return [useHistory];\n});\n\n_c = Corbeille;\nexport default Corbeille;\n\nvar _c;\n\n$RefreshReg$(_c, \"Corbeille\");","map":{"version":3,"sources":["C:/Users/esthe/OneDrive/Desktop/Projet Code/Ouieqare-MERN - Copie/front-end/src/views/examples/Corbeille.js"],"names":["useHistory","React","useState","useEffect","ToastContainer","toast","Button","CardBody","Card","CardHeader","Container","Row","BootstrapTable","paginationFactory","ToolkitProvider","Search","Header","Corbeille","clients","setClients","totalClients","setTotalClients","history","SearchBar","fetchDeletedClients","token","localStorage","getItem","console","error","cleanToken","trim","formattedToken","replace","log","fetch","headers","then","response","ok","Error","status","json","data","length","catch","err","message","columns","dataField","text","hidden","formatter","cellContent","row","restoreClient","_id","deleteClient","clientId","method","success","prevTotal","currentClients","filter","client","props","searchProps","baseProps"],"mappings":"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","sourcesContent":["import { useHistory } from \"react-router-dom\";\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { ToastContainer, toast } from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\n\r\nimport {\r\n  Button,\r\n  CardBody,\r\n  Card,\r\n  CardHeader,\r\n  Container,\r\n  Row,\r\n} from \"reactstrap\";\r\nimport BootstrapTable from \"react-bootstrap-table-next\";\r\nimport paginationFactory from \"react-bootstrap-table2-paginator\";\r\nimport ToolkitProvider, { Search } from \"react-bootstrap-table2-toolkit\";\r\nimport Header from \"components/Headers/Header.js\";\r\nimport 'react-bootstrap-table-next/dist/react-bootstrap-table2.min.css';\r\n\r\n\r\nconst Corbeille = () => {\r\n  const [clients, setClients] = useState([]);\r\n  const [totalClients, setTotalClients] = useState(0);\r\n  const history = useHistory();\r\n  const { SearchBar } = Search;\r\n\r\n  useEffect(() => {\r\n    fetchDeletedClients();\r\n  }, []);\r\n\r\n  const fetchDeletedClients = () => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) {\r\n      console.error('Token not found in localStorage');\r\n      return;\r\n    }\r\n  \r\n    const cleanToken = token.trim();\r\n    const formattedToken = cleanToken.replace('JWT ', '');\r\n  \r\n    console.log(\"Formatted Token from localStorage:\", formattedToken);\r\n  \r\n    fetch('http://localhost:5100/api/clients/deleted', {\r\n      headers: {\r\n         'Authorization': `Bearer ${formattedToken}`\r\n      }\r\n    })\r\n    .then(response => {\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP status ${response.status}`);\r\n      }\r\n      return response.json();\r\n    })\r\n    .then(data => {\r\n      console.log('Deleted clients fetched:', data);\r\n      setClients(data); // Ceci met à jour l'état avec les données récupérées\r\n      setTotalClients(data.length);\r\n    })\r\n    .catch(err => {\r\n      console.error('Error fetching clients:', err.message);\r\n    });\r\n  };\r\n  \r\n  \r\n  \r\n\r\n  // Définition des colonnes du tableau\r\n  const columns = [\r\n    { dataField: \"_id\", text: \"ID\", hidden: true },\r\n    { dataField: \"nom\", text: \"Nom\" },\r\n    { dataField: \"prenom\", text: \"Prénom\" },\r\n    { dataField: \"email\", text: \"Email\" },\r\n    {\r\n      dataField: \"actions\",\r\n      text: \"Actions\",\r\n      formatter: (cellContent, row) => (\r\n        <div>\r\n          <Button color=\"success\" size=\"sm\" onClick={() => restoreClient(row._id)}>\r\n            Restaurer\r\n          </Button>\r\n          {' '}\r\n          <Button color=\"danger\" size=\"sm\" onClick={() => deleteClient(row._id)}>\r\n            <i className=\"fas fa-trash\"></i>\r\n          </Button>\r\n        </div>\r\n      )\r\n    }\r\n];\r\n\r\n\r\n  const restoreClient = (clientId) => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) {\r\n      console.error('Token not found in localStorage');\r\n      return;\r\n    }\r\n  \r\n    const cleanToken = token.trim();\r\n    const formattedToken = cleanToken.replace('JWT ', '');\r\n  \r\n    fetch(`http://localhost:5100/api/clients/restore/${clientId}`, {\r\n      method: 'PUT',\r\n      headers: {\r\n        'Authorization': `Bearer ${formattedToken}`,\r\n        'Content-Type': 'application/json'\r\n      }\r\n    })\r\n    .then(response => {\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP status ${response.status}`);\r\n      }\r\n      return response.json();\r\n    })\r\n    .then(data => {\r\n      if (data.success) {\r\n        setTotalClients(prevTotal => prevTotal - 1);\r\n        toast.success(\"Client restored successfully!\");\r\n        \r\n        setClients(currentClients => currentClients.filter(client => client._id !== clientId));\r\n      } else {\r\n        throw new Error(data.message);\r\n      }\r\n    })\r\n    .catch(error => {\r\n      console.error('Error:', error);\r\n      toast.error(`Error: ${error.message}`);\r\n    });\r\n  };\r\n  \r\n  const deleteClient = (clientId) => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) {\r\n      console.error('Token not found in localStorage');\r\n      return;\r\n    }\r\n  \r\n    const cleanToken = token.trim();\r\n    const formattedToken = cleanToken.replace('JWT ', '');\r\n  \r\n    fetch(`http://localhost:5100/api/clients/deletedef/${clientId}`, {\r\n      method: 'DELETE',\r\n      headers: {\r\n        'Authorization': `Bearer ${formattedToken}`,\r\n        'Content-Type': 'application/json'\r\n      }\r\n    })\r\n    .then(response => {\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP status ${response.status}`);\r\n      }\r\n      return response.json();\r\n    })\r\n    .then(data => {\r\n      if (data.success) {\r\n        toast.success(\"Client supprimé avec succès!\");\r\n        setTotalClients(prevTotal => prevTotal - 1);\r\n        setClients(currentClients => currentClients.filter(client => client._id !== clientId));\r\n      } else {\r\n        throw new Error(data.message);\r\n      }\r\n    })\r\n    .catch(error => {\r\n      console.error('Error:', error);\r\n      toast.error(`Error: ${error.message}`);\r\n    });\r\n};\r\n\r\n\r\n  return (\r\n    <>\r\n    <Header />\r\n    <Container className=\"mt--7\" fluid>\r\n        <ToastContainer position=\"bottom-right\" autoClose={5000} hideProgressBar={false} newestOnTop={false} closeOnClick rtl={false} pauseOnFocusLoss draggable pauseOnHover />\r\n      <Row>\r\n        <div className=\"col\">\r\n          <Card className=\"shadow\">\r\n            <CardHeader className=\"border-0\">\r\n              <h3 className=\"mb-0\">Corbeille (Total : {totalClients})</h3>\r\n            </CardHeader>\r\n            <CardBody>\r\n            <ToolkitProvider\r\n  keyField=\"_id\"\r\n  data={clients}\r\n  columns={columns}\r\n  search\r\n>\r\n\r\n                {\r\n                  props => (\r\n                    <div>\r\n                      <SearchBar {...props.searchProps} />\r\n                      <BootstrapTable\r\n                        {...props.baseProps}\r\n                        bootstrap4\r\n                        pagination={paginationFactory()}\r\n                        noDataIndication=\"Aucun client supprimé trouvé\"\r\n                      />\r\n                    </div>\r\n                  )\r\n                }\r\n              </ToolkitProvider>\r\n            </CardBody>\r\n          </Card>\r\n        </div>\r\n      </Row>\r\n    </Container>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Corbeille;\r\n"]},"metadata":{},"sourceType":"module"}