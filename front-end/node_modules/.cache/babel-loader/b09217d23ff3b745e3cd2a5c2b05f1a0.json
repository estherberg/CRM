{"ast":null,"code":"import _toConsumableArray from \"C:/Users/esthe/OneDrive/Desktop/Projet Code/Ouieqare-MERN - Copie/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"C:/Users/esthe/OneDrive/Desktop/Projet Code/Ouieqare-MERN - Copie/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\esthe\\\\OneDrive\\\\Desktop\\\\Projet Code\\\\Ouieqare-MERN - Copie\\\\front-end\\\\src\\\\views\\\\examples\\\\Clients.js\",\n    _s = $RefreshSig$();\n\nimport { useHistory } from \"react-router-dom\";\nimport React, { useState, useRef, useEffect } from \"react\";\nimport { ToastContainer, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Button, CardBody, Card, CardHeader, Container, Row } from \"reactstrap\";\nimport { useDropzone } from 'react-dropzone';\nimport BootstrapTable from \"react-bootstrap-table-next\";\nimport paginationFactory from \"react-bootstrap-table2-paginator\";\nimport ToolkitProvider, { Search } from \"react-bootstrap-table2-toolkit\";\nimport Header from \"components/Headers/Header.js\";\nimport 'react-bootstrap-table-next/dist/react-bootstrap-table2.min.css';\n\nvar formatDate = function formatDate(isoString) {\n  if (!isoString) return '';\n  var date = new Date(isoString);\n  return date.toLocaleDateString('fr-FR'); // ou 'en-US' selon le format local que vous préférez\n};\n\nvar Tables = function Tables() {\n  _s();\n\n  var history = useHistory();\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      clients = _useState2[0],\n      setClients = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      totalClients = _useState4[0],\n      setTotalClients = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      modal = _useState6[0],\n      setModal = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      isUploading = _useState8[0],\n      setIsUploading = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      uploadSuccess = _useState10[0],\n      setUploadSuccess = _useState10[1];\n\n  var _useState11 = useState(\"\"),\n      _useState12 = _slicedToArray(_useState11, 2),\n      uploadError = _useState12[0],\n      setUploadError = _useState12[1];\n\n  var _useState13 = useState(null),\n      _useState14 = _slicedToArray(_useState13, 2),\n      selectedFile = _useState14[0],\n      setSelectedFile = _useState14[1];\n\n  var _useState15 = useState([]),\n      _useState16 = _slicedToArray(_useState15, 2),\n      selected = _useState16[0],\n      setSelected = _useState16[1];\n\n  var toggleModal = function toggleModal() {\n    setModal(!modal);\n\n    if (!modal) {\n      if (!isUploading && !uploadSuccess) {\n        setSelectedFile(null);\n        setUploadError(\"\");\n      }\n    }\n  };\n\n  var handleOnSelect = function handleOnSelect(row, isSelect) {\n    if (isSelect) {\n      setSelected([].concat(_toConsumableArray(selected), [row.id]));\n    } else {\n      setSelected(selected.filter(function (x) {\n        return x !== row.id;\n      }));\n    }\n  };\n\n  var handleOnSelectAll = function handleOnSelectAll(isSelect, rows) {\n    var ids = rows.map(function (r) {\n      return r.id;\n    });\n\n    if (isSelect) {\n      setSelected(ids);\n    } else {\n      setSelected([]);\n    }\n  };\n\n  var selectRow = {\n    mode: 'checkbox',\n    clickToSelect: true,\n    selected: selected,\n    onSelect: handleOnSelect,\n    onSelectAll: handleOnSelectAll\n  };\n\n  var fetchClients = function fetchClients(setClients) {\n    var token = localStorage.getItem('token');\n\n    if (!token) {\n      console.error('Token not found in localStorage');\n      return;\n    }\n\n    var cleanToken = token.trim();\n    var formattedToken = cleanToken.replace('JWT ', '');\n    console.log(\"Formatted Token from localStorage:\", formattedToken);\n    fetch('http://localhost:5100/api/clients', {\n      headers: {\n        'Authorization': \"Bearer \".concat(formattedToken)\n      }\n    }).then(function (response) {\n      if (!response.ok) {\n        throw new Error(\"HTTP status \".concat(response.status));\n      }\n\n      return response.json();\n    }).then(function (data) {\n      console.log('Clients fetched:', data);\n      setClients(data);\n      setTotalClients(data.length);\n    }).catch(function (err) {\n      console.error('Error fetching clients:', err.message);\n    });\n  };\n\n  var handleAddClient = function handleAddClient() {\n    console.log('Redirection to /admin/nouveauClient');\n    history.push('/admin/nouveauClient');\n  };\n\n  var columns = [{\n    dataField: \"id\",\n    text: \"ID\",\n    hidden: true\n  }, {\n    dataField: \"nom\",\n    text: \"Nom\"\n  }, {\n    dataField: \"prenom\",\n    text: \"Prénom\"\n  }, {\n    dataField: \"email\",\n    text: \"Email\"\n  }, {\n    dataField: \"telephonePortable\",\n    text: \"Téléphone Portable\"\n  }, {\n    dataField: \"ville\",\n    text: \"Ville\"\n  }, {\n    dataField: \"dateNaissance\",\n    text: \"Date de Naissance\",\n    formatter: function formatter(cellContent, row) {\n      return formatDate(row.dateNaissance);\n    }\n  }, {\n    dataField: 'actions',\n    text: 'Actions',\n    formatter: function formatter(cell, row) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        color: \"primary\",\n        size: \"sm\",\n        onClick: function onClick() {\n          return handleEditClient(row);\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fas fa-pencil-alt\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 15\n        }\n      })), ' ', /*#__PURE__*/React.createElement(Button, {\n        color: \"danger\",\n        size: \"sm\",\n        onClick: function onClick() {\n          return handleDeleteClient(row._id);\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fas fa-trash\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 15\n        }\n      })));\n    }\n  }];\n\n  var handleEditClient = function handleEditClient(client) {\n    history.push({\n      pathname: '/admin/nouveauClient',\n      state: {\n        client: client\n      }\n    });\n  };\n\n  var handleDeleteClient = function handleDeleteClient(clientId) {\n    if (window.confirm(\"Êtes-vous sûr de vouloir supprimer ce client ?\")) {\n      fetch(\"http://localhost:5100/api/clients/\".concat(clientId), {\n        method: 'DELETE',\n        headers: {\n          'Authorization': \"Bearer \".concat(localStorage.getItem('token').trim().replace('JWT ', ''))\n        }\n      }).then(function (response) {\n        if (!response.ok) {\n          throw new Error('Failed to delete client');\n        }\n\n        return response.json();\n      }).then(function (data) {\n        if (data.success) {\n          setClients(function (prevClients) {\n            return prevClients.filter(function (client) {\n              return client._id !== clientId;\n            });\n          });\n          setTotalClients(function (prevTotal) {\n            return prevTotal - 1;\n          });\n          toast.success(\"Client deleted successfully!\");\n        } else {\n          console.error('Failed to delete client:', data.message);\n          toast.error(\"Failed to delete client: \" + data.message);\n        }\n      }).catch(function (error) {\n        console.error('Error:', error);\n        toast.error(\"Error: \" + error.message);\n      });\n    }\n  };\n\n  var handleFileUpload = function handleFileUpload() {\n    if (!selectedFile) {\n      toast.warn(\"No file selected for upload.\");\n      return;\n    }\n\n    setIsUploading(true);\n    var formData = new FormData();\n    formData.append('file', selectedFile);\n    fetch('http://localhost:5100/api/clients/import', {\n      method: 'POST',\n      headers: {\n        'Authorization': \"Bearer \".concat(localStorage.getItem('token').trim().replace('JWT ', ''))\n      },\n      body: formData\n    }).then(function (response) {\n      if (!response.ok) {\n        throw new Error('Failed to upload file');\n      }\n\n      return response.json();\n    }).then(function (data) {\n      setUploadSuccess(true);\n      console.log(\"Import success:\", data);\n      fetchClients(setClients);\n      setIsUploading(false);\n      setSelectedFile(null);\n      toast.success(\"File imported successfully!\");\n      toggleModal(); // Ferme le modal après l'importation réussie\n    }).catch(function (err) {\n      console.error(\"Import error:\", err);\n      setIsUploading(false);\n      setUploadError(\"Error during import: \" + err.message);\n      toast.error(\"Error during import: \" + err.message);\n    });\n    setUploadSuccess(false);\n  };\n\n  var pagination = paginationFactory({\n    page: 1,\n    alwaysShowAllBtns: true,\n    withFirstAndLast: false,\n    sizePerPageRenderer: function sizePerPageRenderer(_ref) {\n      var options = _ref.options,\n          currSizePerPage = _ref.currSizePerPage,\n          onSizePerPageChange = _ref.onSizePerPageChange;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"dataTables_length\",\n        id: \"datatable-basic_length\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 9\n        }\n      }, \" \", /*#__PURE__*/React.createElement(\"select\", {\n        name: \"datatable-basic_length\",\n        \"aria-controls\": \"datatable-basic\",\n        className: \"form-control form-control-sm\",\n        onChange: function onChange(e) {\n          return onSizePerPageChange(e.target.value);\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"option\", {\n        value: \"10\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 15\n        }\n      }, \"10\"), /*#__PURE__*/React.createElement(\"option\", {\n        value: \"25\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 15\n        }\n      }, \"25\"), /*#__PURE__*/React.createElement(\"option\", {\n        value: \"50\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 15\n        }\n      }, \"50\"), /*#__PURE__*/React.createElement(\"option\", {\n        value: \"100\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 15\n        }\n      }, \"100\")), \" \"));\n    }\n  });\n  var SearchBar = Search.SearchBar;\n  useEffect(function () {\n    fetchClients(setClients);\n  }, []);\n\n  var _useDropzone = useDropzone({\n    onDrop: function onDrop(acceptedFiles) {\n      console.log(acceptedFiles);\n      setSelectedFile(acceptedFiles[0]);\n      setUploadSuccess(true);\n      setUploadError(\"\"); //toast.info(\"File selected for upload.\");\n    }\n  }),\n      getRootProps = _useDropzone.getRootProps,\n      getInputProps = _useDropzone.getInputProps,\n      isDragActive = _useDropzone.isDragActive;\n\n  var sendEmailsToSelected = function sendEmailsToSelected() {\n    var selectedClients = clients.filter(function (client) {\n      return selected.includes(client.id);\n    });\n    console.log(\"Sending emails to:\", selectedClients.map(function (c) {\n      return c.email;\n    })); // Logique pour envoyer des emails\n  };\n\n  var handleSelectAllClick = function handleSelectAllClick() {\n    if (selected.length < clients.length) {\n      setSelected(clients.map(function (x) {\n        return x.id;\n      }));\n    } else {\n      setSelected([]);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Header, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 282,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(ToastContainer, {\n    position: \"bottom-left\",\n    autoClose: 5000,\n    hideProgressBar: false,\n    newestOnTop: false,\n    closeOnClick: true,\n    rtl: false,\n    pauseOnFocusLoss: true,\n    draggable: true,\n    pauseOnHover: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Container, {\n    className: \"mt--7\",\n    fluid: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 284,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Card, {\n    className: \"shadow\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(CardHeader, {\n    className: \"border-0 d-flex align-items-center justify-content-between\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    className: \"mb-0\",\n    style: {\n      paddingBottom: '10px'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 19\n    }\n  }, \"Clients (Total : \", totalClients, \")\")), /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    color: \"primary\",\n    onClick: handleAddClient,\n    style: {\n      marginRight: '10px'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 19\n    }\n  }, \"Ajouter Client\"), /*#__PURE__*/React.createElement(Button, {\n    color: \"info\",\n    onClick: toggleModal,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 19\n    }\n  }, \"Importer Clients\"), /*#__PURE__*/React.createElement(Button, {\n    color: \"info\",\n    onClick: sendEmailsToSelected,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 19\n    }\n  }, \"Envoyer Mail\"))), /*#__PURE__*/React.createElement(CardBody, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 299,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(ToolkitProvider, {\n    keyField: \"id\",\n    data: clients,\n    columns: columns,\n    search: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 15\n    }\n  }, function (props) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row mb-2\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 303,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-6\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-6 text-right\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 307,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(SearchBar, Object.assign({}, props.searchProps, {\n      className: \"form-control-sm\",\n      placeholder: \"Rechercher\",\n      style: {\n        border: '1px solid black',\n        maxWidth: '250px'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 308,\n        columnNumber: 11\n      }\n    })))), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        overflowX: 'auto'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 311,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(BootstrapTable, Object.assign({}, props.baseProps, {\n      keyField: \"id\",\n      bootstrap4: true,\n      pagination: pagination,\n      selectRow: selectRow,\n      bordered: false,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 312,\n        columnNumber: 9\n      }\n    }))));\n  })))))), /*#__PURE__*/React.createElement(Modal, {\n    isOpen: modal,\n    toggle: toggleModal,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 330,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(ModalHeader, {\n    toggle: toggleModal,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 331,\n      columnNumber: 9\n    }\n  }, \"Importer des fichiers\"), /*#__PURE__*/React.createElement(ModalBody, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 332,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", Object.assign({}, getRootProps({\n    className: 'dropzone'\n  }), {\n    style: {\n      border: '2px dashed #007bff',\n      padding: '20px',\n      textAlign: 'center'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 333,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", Object.assign({}, getInputProps(), {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 334,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fas fa-file-upload fa-2x\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 335,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 336,\n      columnNumber: 13\n    }\n  }, \"Formats support\\xE9s : .csv, .xlsx\"), isDragActive ? /*#__PURE__*/React.createElement(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 338,\n      columnNumber: 15\n    }\n  }, \"Rel\\xE2chez le fichier ici...\") : /*#__PURE__*/React.createElement(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 340,\n      columnNumber: 15\n    }\n  }, \"Glissez-d\\xE9posez des fichiers ici, ou cliquez pour s\\xE9lectionner des fichiers\"), isUploading && /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 342,\n      columnNumber: 29\n    }\n  }, \"Chargement...\"), uploadSuccess && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"alert alert-success\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 343,\n      columnNumber: 31\n    }\n  }, \"Fichier import\\xE9 avec succ\\xE8s!\"), uploadError && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"alert alert-danger\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 344,\n      columnNumber: 29\n    }\n  }, uploadError))), /*#__PURE__*/React.createElement(ModalFooter, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 347,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    color: \"primary\",\n    onClick: handleFileUpload,\n    disabled: !selectedFile,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 348,\n      columnNumber: 11\n    }\n  }, \"OK\"), /*#__PURE__*/React.createElement(Button, {\n    color: \"secondary\",\n    onClick: toggleModal,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 351,\n      columnNumber: 11\n    }\n  }, \"Fermer\"))));\n};\n\n_s(Tables, \"+ZIoUcrQ2x+xyGBYFOvRT/9Cor8=\", false, function () {\n  return [useHistory, useDropzone];\n});\n\n_c = Tables;\nexport default Tables;\n\nvar _c;\n\n$RefreshReg$(_c, \"Tables\");","map":{"version":3,"sources":["C:/Users/esthe/OneDrive/Desktop/Projet Code/Ouieqare-MERN - Copie/front-end/src/views/examples/Clients.js"],"names":["useHistory","React","useState","useRef","useEffect","ToastContainer","toast","Modal","ModalHeader","ModalBody","ModalFooter","Button","CardBody","Card","CardHeader","Container","Row","useDropzone","BootstrapTable","paginationFactory","ToolkitProvider","Search","Header","formatDate","isoString","date","Date","toLocaleDateString","Tables","history","clients","setClients","totalClients","setTotalClients","modal","setModal","isUploading","setIsUploading","uploadSuccess","setUploadSuccess","uploadError","setUploadError","selectedFile","setSelectedFile","selected","setSelected","toggleModal","handleOnSelect","row","isSelect","id","filter","x","handleOnSelectAll","rows","ids","map","r","selectRow","mode","clickToSelect","onSelect","onSelectAll","fetchClients","token","localStorage","getItem","console","error","cleanToken","trim","formattedToken","replace","log","fetch","headers","then","response","ok","Error","status","json","data","length","catch","err","message","handleAddClient","push","columns","dataField","text","hidden","formatter","cellContent","dateNaissance","cell","handleEditClient","handleDeleteClient","_id","client","pathname","state","clientId","window","confirm","method","success","prevClients","prevTotal","handleFileUpload","warn","formData","FormData","append","body","pagination","page","alwaysShowAllBtns","withFirstAndLast","sizePerPageRenderer","options","currSizePerPage","onSizePerPageChange","e","target","value","SearchBar","onDrop","acceptedFiles","getRootProps","getInputProps","isDragActive","sendEmailsToSelected","selectedClients","includes","c","email","handleSelectAllClick","paddingBottom","marginRight","props","searchProps","border","maxWidth","overflowX","baseProps","className","padding","textAlign"],"mappings":"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","sourcesContent":["import { useHistory } from \"react-router-dom\";\r\nimport React, { useState, useRef, useEffect } from \"react\";\r\nimport { ToastContainer, toast } from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\n\r\nimport {\r\n  Modal, ModalHeader, ModalBody, ModalFooter,\r\n  Button,\r\n  CardBody,\r\n  Card,\r\n  CardHeader,\r\n  Container,\r\n  Row,\r\n} from \"reactstrap\";\r\nimport { useDropzone } from 'react-dropzone';\r\nimport BootstrapTable from \"react-bootstrap-table-next\";\r\nimport paginationFactory from \"react-bootstrap-table2-paginator\";\r\nimport ToolkitProvider, { Search } from \"react-bootstrap-table2-toolkit\";\r\nimport Header from \"components/Headers/Header.js\";\r\nimport 'react-bootstrap-table-next/dist/react-bootstrap-table2.min.css';\r\n\r\nconst formatDate = (isoString) => {\r\n  if (!isoString) return '';\r\n  const date = new Date(isoString);\r\n  return date.toLocaleDateString('fr-FR');  // ou 'en-US' selon le format local que vous préférez\r\n}\r\n\r\nconst Tables = () => {\r\n  const history = useHistory();\r\n  const [clients, setClients] = useState([]);\r\n  const [totalClients, setTotalClients] = useState(0);\r\n  const [modal, setModal] = useState(false);\r\n  const [isUploading, setIsUploading] = useState(false);\r\n  const [uploadSuccess, setUploadSuccess] = useState(false);\r\n  const [uploadError, setUploadError] = useState(\"\");\r\n  const [selectedFile, setSelectedFile] = useState(null);\r\n  const [selected, setSelected] = useState([]);\r\n\r\n  const toggleModal = () => {\r\n    setModal(!modal);\r\n    if (!modal) {\r\n      if (!isUploading && !uploadSuccess) {\r\n        setSelectedFile(null);\r\n        setUploadError(\"\");\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleOnSelect = (row, isSelect) => {\r\n    if (isSelect) {\r\n      setSelected([...selected, row.id]);\r\n    } else {\r\n      setSelected(selected.filter(x => x !== row.id));\r\n    }\r\n  };\r\n\r\n  const handleOnSelectAll = (isSelect, rows) => {\r\n    const ids = rows.map(r => r.id);\r\n    if (isSelect) {\r\n      setSelected(ids);\r\n    } else {\r\n      setSelected([]);\r\n    }\r\n  };\r\n\r\n  const selectRow = {\r\n    mode: 'checkbox',\r\n    clickToSelect: true,\r\n    selected: selected,\r\n    onSelect: handleOnSelect,\r\n    onSelectAll: handleOnSelectAll\r\n  };\r\n\r\n  const fetchClients = (setClients) => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) {\r\n      console.error('Token not found in localStorage');\r\n      return;\r\n    }\r\n\r\n    const cleanToken = token.trim();\r\n    const formattedToken = cleanToken.replace('JWT ', '');\r\n\r\n    console.log(\"Formatted Token from localStorage:\", formattedToken);\r\n\r\n    fetch('http://localhost:5100/api/clients', {\r\n      headers: {\r\n        'Authorization': `Bearer ${formattedToken}`\r\n      }\r\n    })\r\n      .then(response => {\r\n        if (!response.ok) {\r\n          throw new Error(`HTTP status ${response.status}`);\r\n        }\r\n        return response.json();\r\n      })\r\n      .then(data => {\r\n        console.log('Clients fetched:', data);\r\n        setClients(data);\r\n        setTotalClients(data.length);\r\n      })\r\n      .catch(err => {\r\n        console.error('Error fetching clients:', err.message);\r\n      });\r\n  };\r\n\r\n  const handleAddClient = () => {\r\n    console.log('Redirection to /admin/nouveauClient');\r\n    history.push('/admin/nouveauClient');\r\n  };\r\n\r\n  const columns = [\r\n    { dataField: \"id\", text: \"ID\", hidden: true },\r\n    { dataField: \"nom\", text: \"Nom\" },\r\n    { dataField: \"prenom\", text: \"Prénom\" },\r\n    { dataField: \"email\", text: \"Email\" },\r\n    { dataField: \"telephonePortable\", text: \"Téléphone Portable\" },\r\n    { dataField: \"ville\", text: \"Ville\" },\r\n    {\r\n      dataField: \"dateNaissance\",\r\n      text: \"Date de Naissance\",\r\n      formatter: (cellContent, row) => {\r\n        return formatDate(row.dateNaissance);\r\n      }\r\n    },\r\n    {\r\n      dataField: 'actions',\r\n      text: 'Actions',\r\n      formatter: (cell, row) => {\r\n        return (\r\n          <div>\r\n            <Button color=\"primary\" size=\"sm\" onClick={() => handleEditClient(row)}>\r\n              <i className=\"fas fa-pencil-alt\" />\r\n            </Button>\r\n            {' '}\r\n            <Button color=\"danger\" size=\"sm\" onClick={() => handleDeleteClient(row._id)}>\r\n              <i className=\"fas fa-trash\" />\r\n            </Button>\r\n          </div>\r\n        );\r\n      }\r\n    }\r\n  ];\r\n\r\n  const handleEditClient = (client) => {\r\n    history.push({\r\n      pathname: '/admin/nouveauClient',\r\n      state: { client: client }\r\n    });\r\n  };\r\n\r\n  const handleDeleteClient = (clientId) => {\r\n    if (window.confirm(\"Êtes-vous sûr de vouloir supprimer ce client ?\")) {\r\n      fetch(`http://localhost:5100/api/clients/${clientId}`, {\r\n        method: 'DELETE',\r\n        headers: {\r\n          'Authorization': `Bearer ${localStorage.getItem('token').trim().replace('JWT ', '')}`\r\n        }\r\n      })\r\n        .then(response => {\r\n          if (!response.ok) {\r\n            throw new Error('Failed to delete client');\r\n          }\r\n          return response.json();\r\n        })\r\n        .then(data => {\r\n          if (data.success) {\r\n            setClients(prevClients => prevClients.filter(client => client._id !== clientId));\r\n            setTotalClients(prevTotal => prevTotal - 1);\r\n            toast.success(\"Client deleted successfully!\");\r\n          } else {\r\n            console.error('Failed to delete client:', data.message);\r\n            toast.error(\"Failed to delete client: \" + data.message);\r\n          }\r\n        })\r\n        .catch(error => {\r\n          console.error('Error:', error);\r\n          toast.error(\"Error: \" + error.message);\r\n        });\r\n    }\r\n  };\r\n\r\n  const handleFileUpload = () => {\r\n    if (!selectedFile) {\r\n      toast.warn(\"No file selected for upload.\");\r\n      return;\r\n    }\r\n\r\n    setIsUploading(true);\r\n    const formData = new FormData();\r\n    formData.append('file', selectedFile);\r\n\r\n    fetch('http://localhost:5100/api/clients/import', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Authorization': `Bearer ${localStorage.getItem('token').trim().replace('JWT ', '')}`\r\n      },\r\n      body: formData\r\n    })\r\n      .then(response => {\r\n        if (!response.ok) {\r\n          throw new Error('Failed to upload file');\r\n        }\r\n        return response.json();\r\n      })\r\n      .then(data => {\r\n        setUploadSuccess(true);\r\n        console.log(\"Import success:\", data);\r\n        fetchClients(setClients);\r\n        setIsUploading(false);\r\n        \r\n        setSelectedFile(null);\r\n        toast.success(\"File imported successfully!\");\r\n        toggleModal(); // Ferme le modal après l'importation réussie\r\n      })\r\n      .catch(err => {\r\n        console.error(\"Import error:\", err);\r\n        setIsUploading(false);\r\n        setUploadError(\"Error during import: \" + err.message);\r\n        toast.error(\"Error during import: \" + err.message);\r\n      });\r\n      setUploadSuccess(false);\r\n  };\r\n\r\n  const pagination = paginationFactory({\r\n    page: 1,\r\n    alwaysShowAllBtns: true,\r\n    withFirstAndLast: false,\r\n    sizePerPageRenderer: ({ options, currSizePerPage, onSizePerPageChange }) => (\r\n      <div className=\"dataTables_length\" id=\"datatable-basic_length\">\r\n        <label>\r\n          {\" \"}\r\n          {\r\n            <select\r\n              name=\"datatable-basic_length\"\r\n              aria-controls=\"datatable-basic\"\r\n              className=\"form-control form-control-sm\"\r\n              onChange={e => onSizePerPageChange(e.target.value)}\r\n            >\r\n              <option value=\"10\">10</option>\r\n              <option value=\"25\">25</option>\r\n              <option value=\"50\">50</option>\r\n              <option value=\"100\">100</option>\r\n            </select>\r\n          }{\" \"}\r\n        </label>\r\n      </div>\r\n    )\r\n  });\r\n\r\n  const { SearchBar } = Search;\r\n  useEffect(() => {\r\n    fetchClients(setClients);\r\n  }, []);\r\n  \r\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\r\n    onDrop: acceptedFiles => {\r\n      console.log(acceptedFiles);\r\n      setSelectedFile(acceptedFiles[0]);\r\n      setUploadSuccess(true);\r\n      setUploadError(\"\");\r\n      //toast.info(\"File selected for upload.\");\r\n    }\r\n  });\r\n\r\n  const sendEmailsToSelected = () => {\r\n    const selectedClients = clients.filter(client => selected.includes(client.id));\r\n    console.log(\"Sending emails to:\", selectedClients.map(c => c.email));\r\n    // Logique pour envoyer des emails\r\n  };\r\n\r\n  const handleSelectAllClick = () => {\r\n    if (selected.length < clients.length) {\r\n      setSelected(clients.map(x => x.id));\r\n    } else {\r\n      setSelected([]);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Header />\r\n      <ToastContainer position=\"bottom-left\" autoClose={5000} hideProgressBar={false} newestOnTop={false} closeOnClick rtl={false} pauseOnFocusLoss draggable pauseOnHover />\r\n      <Container className=\"mt--7\" fluid>\r\n        <Row>\r\n          <div className=\"col\">\r\n            <Card className=\"shadow\">\r\n              <CardHeader className=\"border-0 d-flex align-items-center justify-content-between\">\r\n                <div>\r\n                  <h3 className=\"mb-0\" style={{ paddingBottom: '10px' }}>Clients (Total : {totalClients})</h3>\r\n                  {/* <Button color=\"info\" onClick={handleSelectAllClick}>Sélectionner Tout</Button> */}\r\n                </div>\r\n                <div>\r\n                  <Button color=\"primary\" onClick={handleAddClient} style={{ marginRight: '10px' }}>Ajouter Client</Button>\r\n                  <Button color=\"info\" onClick={toggleModal}>Importer Clients</Button>\r\n                  <Button color=\"info\" onClick={sendEmailsToSelected}>Envoyer Mail</Button>\r\n                </div>\r\n              </CardHeader>\r\n              <CardBody>\r\n              <ToolkitProvider keyField=\"id\" data={clients} columns={columns} search>\r\n  {props => (\r\n    <div>\r\n      <div className=\"row mb-2\">\r\n        <div className=\"col-6\">\r\n          {/* Ici, vous pouvez remettre les boutons ou autres éléments comme avant */}\r\n        </div>\r\n        <div className=\"col-6 text-right\">\r\n          <SearchBar {...props.searchProps} className=\"form-control-sm\" placeholder=\"Rechercher\" style={{ border: '1px solid black', maxWidth: '250px' }} />\r\n        </div>\r\n      </div>\r\n      <div style={{ overflowX: 'auto' }}>\r\n        <BootstrapTable\r\n          {...props.baseProps}\r\n          keyField=\"id\"\r\n          bootstrap4\r\n          pagination={pagination}\r\n          selectRow={selectRow}\r\n          bordered={false}\r\n        />\r\n      </div>\r\n    </div>\r\n  )}\r\n</ToolkitProvider>\r\n\r\n              </CardBody>\r\n            </Card>\r\n          </div>\r\n        </Row>\r\n      </Container>\r\n      <Modal isOpen={modal} toggle={toggleModal}>\r\n        <ModalHeader toggle={toggleModal}>Importer des fichiers</ModalHeader>\r\n        <ModalBody>\r\n          <div {...getRootProps({ className: 'dropzone' })} style={{ border: '2px dashed #007bff', padding: '20px', textAlign: 'center' }}>\r\n            <input {...getInputProps()} />\r\n            <i className=\"fas fa-file-upload fa-2x\"></i>\r\n            <p>Formats supportés : .csv, .xlsx</p>\r\n            {isDragActive ? (\r\n              <p>Relâchez le fichier ici...</p>\r\n            ) : (\r\n              <p>Glissez-déposez des fichiers ici, ou cliquez pour sélectionner des fichiers</p>\r\n            )}\r\n            {isUploading && <div>Chargement...</div>}\r\n            {uploadSuccess && <div className=\"alert alert-success\">Fichier importé avec succès!</div>}\r\n            {uploadError && <div className=\"alert alert-danger\">{uploadError}</div>}\r\n          </div>\r\n        </ModalBody>\r\n        <ModalFooter>\r\n          <Button color=\"primary\" onClick={handleFileUpload} disabled={!selectedFile}>\r\n            OK\r\n          </Button>\r\n          <Button color=\"secondary\" onClick={toggleModal}>Fermer</Button>\r\n        </ModalFooter>\r\n      </Modal>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Tables;\r\n"]},"metadata":{},"sourceType":"module"}