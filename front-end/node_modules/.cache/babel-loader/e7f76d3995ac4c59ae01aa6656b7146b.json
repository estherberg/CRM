{"ast":null,"code":"import _slicedToArray from \"C:/Users/Esther Elbaz/Desktop/Projet Code/Ouieqare-MERN - Copie/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\Esther Elbaz\\\\Desktop\\\\Projet Code\\\\Ouieqare-MERN - Copie\\\\front-end\\\\src\\\\views\\\\examples\\\\Clients.js\",\n    _s = $RefreshSig$();\n\nimport { useHistory } from \"react-router-dom\";\nimport React, { useState, useRef, useEffect } from \"react\";\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Button //ButtonGroup,\n, CardBody, Card //Col,\n, CardHeader, Container, Row } from \"reactstrap\"; //import ReactToPrint from \"react-to-print\";\n\nimport { useDropzone } from 'react-dropzone';\nimport BootstrapTable from \"react-bootstrap-table-next\";\nimport paginationFactory from \"react-bootstrap-table2-paginator\";\nimport ToolkitProvider, { Search } from \"react-bootstrap-table2-toolkit\";\nimport Header from \"components/Headers/Header.js\";\nimport 'react-bootstrap-table-next/dist/react-bootstrap-table2.min.css';\n\nvar formatDate = function formatDate(isoString) {\n  if (!isoString) return '';\n  var date = new Date(isoString);\n  return date.toLocaleDateString('fr-FR'); // ou 'en-US' selon le format local que vous préférez\n};\n\nvar selectRow = {\n  mode: 'checkbox',\n  clickToSelect: true,\n  style: {\n    backgroundColor: '#c8e6c9'\n  },\n  onSelect: function onSelect(row, isSelect, rowIndex, e) {\n    console.log(row.id + \" selected: \" + isSelect);\n  },\n  onSelectAll: function onSelectAll(isSelect, rows, e) {\n    console.log(\"Select all: \" + isSelect);\n  }\n};\n\nvar Tables = function Tables() {\n  _s();\n\n  //const [modal, setModal] = useState(false);\n  //const toggleModal = () => setModal(!modal);\n  var history = useHistory();\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      clients = _useState2[0],\n      setClients = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      totalClients = _useState4[0],\n      setTotalClients = _useState4[1];\n\n  var componentRef = useRef(null); //const inputFileRef = useRef(null);\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      modal = _useState6[0],\n      setModal = _useState6[1];\n\n  var toggleModal = function toggleModal() {\n    setModal(!modal);\n\n    if (!modal) {\n      // Si le modal va être ouvert, ne réinitialisez pas\n      // Réinitialisez tout seulement si le modal est fermé sans importer\n      if (!isUploading && !uploadSuccess) {\n        setSelectedFile(null);\n        setUploadError(\"\");\n      }\n    }\n  };\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      isUploading = _useState8[0],\n      setIsUploading = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      uploadSuccess = _useState10[0],\n      setUploadSuccess = _useState10[1];\n\n  var _useState11 = useState(\"\"),\n      _useState12 = _slicedToArray(_useState11, 2),\n      uploadError = _useState12[0],\n      setUploadError = _useState12[1];\n\n  var _useState13 = useState(null),\n      _useState14 = _slicedToArray(_useState13, 2),\n      selectedFile = _useState14[0],\n      setSelectedFile = _useState14[1];\n\n  var _useState15 = useState([]),\n      _useState16 = _slicedToArray(_useState15, 2),\n      selected = _useState16[0],\n      setSelected = _useState16[1];\n\n  var handleSelectAll = function handleSelectAll(isSelectAll) {\n    if (isSelectAll) {\n      var ids = clients.map(function (client) {\n        return client.id;\n      });\n      setSelected(ids);\n    } else {\n      setSelected([]);\n    }\n  }; // Ajoutez cette option à votre `selectRow`:\n\n\n  selectRow.onSelectAll = function (isSelect, rows, e) {\n    if (isSelect) {\n      handleSelectAll(true);\n    } else {\n      handleSelectAll(false);\n    }\n  };\n\n  var fetchClients = function fetchClients(setClients) {\n    // Pass setClients as a parameter\n    var token = localStorage.getItem('token');\n\n    if (!token) {\n      console.error('Token not found in localStorage');\n      return;\n    }\n\n    var cleanToken = token.trim();\n    var formattedToken = cleanToken.replace('JWT ', '');\n    console.log(\"Formatted Token from localStorage:\", formattedToken);\n    fetch('http://localhost:5100/api/clients', {\n      headers: {\n        'Authorization': \"Bearer \".concat(formattedToken)\n      }\n    }).then(function (response) {\n      if (!response.ok) {\n        throw new Error(\"HTTP status \".concat(response.status));\n      }\n\n      return response.json();\n    }).then(function (data) {\n      console.log('Clients fetched:', data);\n      setClients(data); // Ensure this line is uncommented and correctly used\n\n      setTotalClients(data.length);\n    }).catch(function (err) {\n      console.error('Error fetching clients:', err.message);\n    });\n  };\n\n  var handleAddClient = function handleAddClient() {\n    console.log('Redirection to /admin/nouveauClient');\n    history.push('/admin/nouveauClient');\n  };\n\n  var columns = [{\n    dataField: \"id\",\n    text: \"ID\",\n    hidden: true\n  }, {\n    dataField: \"nom\",\n    text: \"Nom\"\n  }, {\n    dataField: \"prenom\",\n    text: \"Prénom\"\n  }, {\n    dataField: \"email\",\n    text: \"Email\"\n  }, {\n    dataField: \"telephonePortable\",\n    text: \"Téléphone Portable\"\n  }, {\n    dataField: \"ville\",\n    text: \"Ville\"\n  }, {\n    dataField: \"dateNaissance\",\n    text: \"Date de Naissance\",\n    formatter: function formatter(cellContent, row) {\n      return formatDate(row.dateNaissance); // Formate la date avant de l'afficher\n    }\n  }, {\n    dataField: 'actions',\n    text: 'Actions',\n    formatter: function formatter(cell, row) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        color: \"primary\",\n        size: \"sm\",\n        onClick: function onClick() {\n          return handleEditClient(row);\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fas fa-pencil-alt\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 15\n        }\n      })), ' ', /*#__PURE__*/React.createElement(Button, {\n        color: \"danger\",\n        size: \"sm\",\n        onClick: function onClick() {\n          return handleDeleteClient(row._id);\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fas fa-trash\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 15\n        }\n      })));\n    }\n  }]; // Fonction pour gérer la modification des clients\n\n  var handleEditClient = function handleEditClient(client) {\n    history.push({\n      pathname: '/admin/nouveauClient',\n      state: {\n        client: client\n      }\n    });\n  }; // Fonction pour gérer la suppression des clients\n\n\n  var handleDeleteClient = function handleDeleteClient(clientId) {\n    if (window.confirm(\"Êtes-vous sûr de vouloir supprimer ce client ?\")) {\n      fetch(\"http://localhost:5100/api/clients/\".concat(clientId), {\n        method: 'DELETE',\n        headers: {\n          'Authorization': \"Bearer \".concat(localStorage.getItem('token').trim().replace('JWT ', ''))\n        }\n      }).then(function (response) {\n        if (!response.ok) {\n          throw new Error('Failed to delete client');\n        }\n\n        return response.json(); // Assurez-vous que le serveur renvoie une réponse JSON\n      }).then(function (data) {\n        if (data.success) {\n          setClients(function (prevClients) {\n            return prevClients.filter(function (client) {\n              return client._id !== clientId;\n            });\n          });\n          setTotalClients(function (prevTotal) {\n            return prevTotal - 1;\n          }); // ou utilisez une autre méthode de mise à jour de l'état si vous utilisez un autre état global comme Redux\n        } else {\n          console.error('Failed to delete client:', data.message);\n        }\n      }).catch(function (error) {\n        return console.error('Error:', error);\n      });\n    }\n  };\n\n  var handleFileUpload = function handleFileUpload() {\n    if (!selectedFile) return;\n    setIsUploading(true);\n    var formData = new FormData();\n    formData.append('file', selectedFile);\n    fetch('http://localhost:5100/api/clients/import', {\n      method: 'POST',\n      headers: {\n        'Authorization': \"Bearer \".concat(localStorage.getItem('token').trim().replace('JWT ', ''))\n      },\n      body: formData\n    }).then(function (response) {\n      if (!response.ok) {\n        throw new Error('Échec de l\\'importation');\n      }\n\n      return response.json();\n    }).then(function (data) {\n      console.log(\"Import success:\", data);\n      fetchClients(setClients); // Refresh the client list after import\n\n      setIsUploading(false);\n      setUploadSuccess(true);\n      setSelectedFile(null); // Clear file after upload\n    }).catch(function (err) {\n      console.error(\"Import error:\", err);\n      setIsUploading(false);\n      setUploadError(\"Erreur lors de l'importation: \" + err.message);\n    });\n  };\n\n  var pagination = paginationFactory({\n    page: 1,\n    alwaysShowAllBtns: true,\n    //showTotal: true,\n    withFirstAndLast: false,\n    sizePerPageRenderer: function sizePerPageRenderer(_ref) {\n      var options = _ref.options,\n          currSizePerPage = _ref.currSizePerPage,\n          onSizePerPageChange = _ref.onSizePerPageChange;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"dataTables_length\",\n        id: \"datatable-basic_length\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 9\n        }\n      }, \" \", /*#__PURE__*/React.createElement(\"select\", {\n        name: \"datatable-basic_length\",\n        \"aria-controls\": \"datatable-basic\",\n        className: \"form-control form-control-sm\",\n        onChange: function onChange(e) {\n          return onSizePerPageChange(e.target.value);\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"option\", {\n        value: \"10\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 15\n        }\n      }, \"10\"), /*#__PURE__*/React.createElement(\"option\", {\n        value: \"25\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 15\n        }\n      }, \"25\"), /*#__PURE__*/React.createElement(\"option\", {\n        value: \"50\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 15\n        }\n      }, \"50\"), /*#__PURE__*/React.createElement(\"option\", {\n        value: \"100\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 15\n        }\n      }, \"100\")), \" \"));\n    }\n  });\n  var SearchBar = Search.SearchBar;\n  useEffect(function () {\n    fetchClients(setClients); // Pass setClients here\n  }, []);\n\n  var _useDropzone = useDropzone({\n    onDrop: function onDrop(acceptedFiles) {\n      console.log(acceptedFiles);\n      setSelectedFile(acceptedFiles[0]); // Assurez-vous que c'est bien un fichier\n\n      setUploadSuccess(false);\n      setUploadError(\"\");\n    }\n  }),\n      getRootProps = _useDropzone.getRootProps,\n      getInputProps = _useDropzone.getInputProps,\n      isDragActive = _useDropzone.isDragActive;\n\n  var sendGroupEmail = function sendGroupEmail() {\n    var selectedClients = clients.filter(function (client) {\n      return selected.includes(client.id);\n    });\n    console.log(\"Envoi d'e-mails à:\", selectedClients.map(function (client) {\n      return client.email;\n    })); // Ici, vous ajouterez votre logique d'envoi de mails\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Header, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 282,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(Container, {\n    className: \"mt--7\",\n    fluid: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 284,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Card, {\n    className: \"shadow\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(CardHeader, {\n    className: \"border-0 d-flex align-items-center justify-content-between\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    className: \"mb-0\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 5\n    }\n  }, \"Clients (Total : \", totalClients, \")\")), /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 291,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    color: \"primary\",\n    onClick: handleAddClient,\n    style: {\n      marginRight: '10px'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 292,\n      columnNumber: 5\n    }\n  }, \"Ajouter Client\"), /*#__PURE__*/React.createElement(Button, {\n    color: \"info\",\n    onClick: toggleModal,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 5\n    }\n  }, \"Importer Clients\"), /*#__PURE__*/React.createElement(Button, {\n    color: \"info\",\n    onClick: sendGroupEmail,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 5\n    }\n  }, \"Envoyer Mail\"))), /*#__PURE__*/React.createElement(CardBody, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 299,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(ToolkitProvider, {\n    keyField: \"id\",\n    data: clients,\n    columns: columns,\n    search: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 15\n    }\n  }, function (props) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(SearchBar, Object.assign({}, props.searchProps, {\n      style: {\n        border: '1px solid black'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 303,\n        columnNumber: 21\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        overflowX: 'auto'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(BootstrapTable, Object.assign({}, props.baseProps, {\n      ref: componentRef,\n      bootstrap4: true,\n      pagination: pagination,\n      bordered: false,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 305,\n        columnNumber: 23\n      }\n    }))));\n  })))))), /*#__PURE__*/React.createElement(Modal, {\n    isOpen: modal,\n    toggle: toggleModal,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(ModalHeader, {\n    toggle: toggleModal,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 3\n    }\n  }, \"Importer des fichiers\"), /*#__PURE__*/React.createElement(ModalBody, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", Object.assign({}, getRootProps({\n    className: 'dropzone'\n  }), {\n    style: {\n      border: '2px dashed #007bff',\n      padding: '20px',\n      textAlign: 'center'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 318,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", Object.assign({}, getInputProps(), {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 7\n    }\n  })), /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fas fa-file-upload fa-2x\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 320,\n      columnNumber: 7\n    }\n  }), \" \", /*#__PURE__*/React.createElement(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 322,\n      columnNumber: 7\n    }\n  }, \"Formats support\\xE9s : .csv, .xlsx\"), isDragActive ? /*#__PURE__*/React.createElement(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 9\n    }\n  }, \"Rel\\xE2chez le fichier ici...\") : /*#__PURE__*/React.createElement(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 9\n    }\n  }, \"Glissez-d\\xE9posez des fichiers ici, ou cliquez pour s\\xE9lectionner des fichiers\"), isUploading && /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 23\n    }\n  }, \"Chargement...\"), uploadSuccess && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"alert alert-success\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 329,\n      columnNumber: 25\n    }\n  }, \"Fichier import\\xE9 avec succ\\xE8s!\"), uploadError && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"alert alert-danger\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 330,\n      columnNumber: 23\n    }\n  }, uploadError))), /*#__PURE__*/React.createElement(ModalFooter, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 333,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    color: \"primary\",\n    onClick: handleFileUpload,\n    disabled: !selectedFile,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 334,\n      columnNumber: 3\n    }\n  }, \"OK\"), /*#__PURE__*/React.createElement(Button, {\n    color: \"secondary\",\n    onClick: toggleModal,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 337,\n      columnNumber: 3\n    }\n  }, \"Fermer\"))));\n};\n\n_s(Tables, \"P9WO6E9OJoME89+6zAv3mdftZro=\", false, function () {\n  return [useHistory, useDropzone];\n});\n\n_c = Tables;\nexport default Tables; // import { useHistory } from \"react-router-dom\";\n// import React, { useState, useRef, useEffect } from \"react\";\n// import {\n//   Button,\n//   //ButtonGroup,\n//   CardBody,\n//   Card,\n//   //Col,\n//   CardHeader,\n//   Container,\n//   Row,\n// } from \"reactstrap\";\n// //import ReactToPrint from \"react-to-print\";\n// import BootstrapTable from \"react-bootstrap-table-next\";\n// import paginationFactory from \"react-bootstrap-table2-paginator\";\n// import ToolkitProvider, { Search } from \"react-bootstrap-table2-toolkit\";\n// //import ReactBSAlert from \"react-bootstrap-sweetalert\";\n// import Header from \"components/Headers/Header.js\";\n// //import { dataTable } from \"variables/general\";\n// const formatDate = (isoString) => {\n//   if (!isoString) return '';\n//   const date = new Date(isoString);\n//   return date.toLocaleDateString('fr-FR');  // ou 'en-US' selon le format local que vous préférez\n// }\n// const fetchClients = (setClients) => { // Pass setClients as a parameter\n//   const token = localStorage.getItem('token');\n//   if (!token) {\n//       console.error('Token not found in localStorage');\n//       return;\n//   }\n//   const cleanToken = token.trim();\n//   const formattedToken = cleanToken.replace('JWT ', '');\n//   console.log(\"Formatted Token from localStorage:\", formattedToken);\n//   fetch('http://localhost:5100/api/clients', {\n//       headers: {\n//           'Authorization': Bearer ${formattedToken}\n//       }\n//   })\n//   .then(response => {\n//       if (!response.ok) {\n//           throw new Error(HTTP status ${response.status});\n//       }\n//       return response.json();\n//   })\n//   .then(data => {\n//       console.log('Clients fetched:', data);\n//       setClients(data); // Ensure this line is uncommented and correctly used\n//   })\n//   .catch(err => {\n//       console.error('Error fetching clients:', err.message);\n//   });\n// };\n// const Tables = () => {\n//   //const [modal, setModal] = useState(false);\n//   //const toggleModal = () => setModal(!modal);\n//   const history = useHistory();\n//   const [clients, setClients] = useState([]);\n//   const componentRef = useRef(null);\n//   const inputFileRef = useRef(null);\n// const handleAddClient = () => {\n//   console.log('Redirection to /admin/nouveauClient');\n//     history.push('/admin/nouveauClient');\n//   };\n//   const columns = [\n//     { dataField: \"id\", text: \"ID\", hidden: true },\n//     { dataField: \"nom\", text: \"Nom\" },\n//     { dataField: \"prenom\", text: \"Prénom\" },\n//     { dataField: \"email\", text: \"Email\" },\n//     { dataField: \"telephonePortable\", text: \"Téléphone Portable\" },\n//     { dataField: \"ville\", text: \"Ville\" },\n//     {\n//       dataField: \"dateNaissance\",\n//       text: \"Date de Naissance\",\n//       formatter: (cellContent, row) => {\n//         return formatDate(row.dateNaissance);  // Formate la date avant de l'afficher\n//       }\n//     },\n//     {\n//       dataField: 'actions',\n//       text: 'Actions',\n//       formatter: (cell, row) => {\n//         return (\n//           <div>\n//             <Button color=\"primary\" size=\"sm\" onClick={() => handleEditClient(row)}>\n//               <i className=\"fas fa-pencil-alt\" />\n//             </Button>\n//             {' '}\n//             <Button color=\"danger\" size=\"sm\" onClick={() => handleDeleteClient(row._id)}>\n//               <i className=\"fas fa-trash\" />\n//             </Button>\n//           </div>\n//         );\n//       }\n//     }\n//   ];\n//   // Fonction pour gérer la modification des clients\n//   const handleEditClient = (client) => {\n//     history.push({\n//       pathname: '/admin/nouveauClient',\n//       state: { client: client }\n//     });\n//   };\n//   // Fonction pour gérer la suppression des clients\n//   const handleDeleteClient = (clientId) => {\n//     if (window.confirm(\"Êtes-vous sûr de vouloir supprimer ce client ?\")) {\n//       fetch(http://localhost:5100/api/clients/${clientId}, {\n//         method: 'DELETE',\n//         headers: {\n//           'Authorization': Bearer ${localStorage.getItem('token').trim().replace('JWT ', '')}\n//         }\n//       })\n//       .then(response => {\n//         if (!response.ok) {\n//           throw new Error('Failed to delete client');\n//         }\n//         return response.json();  // Assurez-vous que le serveur renvoie une réponse JSON\n//       })\n//       .then(data => {\n//         if (data.success) {\n//           setClients(prevClients => prevClients.filter(client => client._id !== clientId));\n//           // ou utilisez une autre méthode de mise à jour de l'état si vous utilisez un autre état global comme Redux\n//         } else {\n//           console.error('Failed to delete client:', data.message);\n//         }\n//       })\n//       .catch(error => console.error('Error:', error));\n//     }\n//   };\n//   // const handleFileUpload = (event) => {\n//   //   const file = event.target.files[0];\n//   //   if (file) {\n//   //     const reader = new FileReader();\n//   //     reader.onload = (e) => {\n//   //       const text = e.target.result;\n//   //       // Convertir CSV en JSON ici ou envoyer le texte brut au serveur pour traitement\n//   //       uploadData(text);\n//   //     };\n//   //     reader.readAsText(file);\n//   //   }\n//   // };\n//   // const uploadData = (data) => {\n//   //   fetch('http://localhost:5100/api/clients/import', {\n//   //     method: 'POST',\n//   //     headers: {\n//   //       'Content-Type': 'application/json',\n//   //       'Authorization': Bearer ${localStorage.getItem('token').trim().replace('JWT ', '')}\n//   //     },\n//   //     body: JSON.stringify({ data })\n//   //   })\n//   //   .then(response => response.json())\n//   //   .then(data => {\n//   //     console.log(\"Import success:\", data);\n//   //     fetchClients(setClients);  // Rafraîchir la liste des clients après l'import\n//   //   })\n//   //   .catch(err => console.error(\"Import error:\", err));\n//   // };\n//   // // Ajouter un bouton et input dans le JSX\n//   const handleFileUpload = (event) => {\n//     const file = event.target.files[0];\n//     if (!file) return;\n//     const formData = new FormData();\n//     formData.append('file', file);\n//     fetch('http://localhost:5100/api/clients/import', {\n//         method: 'POST',\n//         headers: {\n//           'Authorization': Bearer ${localStorage.getItem('token').trim().replace('JWT ', '')}\n//         },\n//         body: formData\n//     })\n//     .then(response => response.json())\n//     .then(data => {\n//         console.log(\"Import success:\", data);\n//         fetchClients(setClients);  // Refresh the client list after import\n//     })\n//     .catch(err => console.error(\"Import error:\", err));\n// };\n//   const pagination = paginationFactory({\n//     page: 1,\n//     alwaysShowAllBtns: true,\n//     //showTotal: true,\n//     withFirstAndLast: false,\n//     sizePerPageRenderer: ({ options, currSizePerPage, onSizePerPageChange }) => (\n//       <div className=\"dataTables_length\" id=\"datatable-basic_length\">\n//         <label>\n//           {\" \"}\n//           {\n//             <select\n//               name=\"datatable-basic_length\"\n//               aria-controls=\"datatable-basic\"\n//               className=\"form-control form-control-sm\"\n//               onChange={e => onSizePerPageChange(e.target.value)}\n//             >\n//               <option value=\"10\">10</option>\n//               <option value=\"25\">25</option>\n//               <option value=\"50\">50</option>\n//               <option value=\"100\">100</option>\n//             </select>\n//           }{\" \"}\n//         </label>\n//       </div>\n//     )\n//   });\n//   const { SearchBar } = Search;\n//   useEffect(() => {\n//     fetchClients(setClients); // Pass setClients here\n// }, []); \n//   return (\n//     <>\n//       <Header />\n//       <Container className=\"mt--7\" fluid>\n//         <Row>\n//           <div className=\"col\">\n//             <Card className=\"shadow\">\n//               <CardHeader className=\"border-0 d-flex align-items-center justify-content-between\">\n//                 <h3 className=\"mb-0\">Clients</h3>\n//                 <input type=\"file\" onChange={handleFileUpload} accept=\".csv\" style={{ display: 'none' }} ref={inputFileRef} />\n// <Button color=\"info\" onClick={() => inputFileRef.current && inputFileRef.current.click()}>\n//   Importer Clients\n// </Button>\n//                 {/* <Button color=\"primary\" onClick={toggleModal}>Ajouter Client</Button> */}\n//                 <Button color=\"primary\" onClick={handleAddClient}>Ajouter Client</Button>\n//               </CardHeader>\n//               <CardBody>\n//                 <ToolkitProvider\n//                   keyField=\"id\"\n//                   data={clients}\n//                   columns={columns}\n//                   search\n//                 >\n//                   {props => (\n//                     <div>\n//                       <SearchBar {...props.searchProps} style={{ border: '1px solid black' }} />\n//                       <div style={{ overflowX: 'auto' }}>\n//                         <BootstrapTable\n//                           {...props.baseProps}\n//                           ref={componentRef}\n//                           bootstrap4\n//                           pagination={pagination}\n//                           bordered={false}\n//                         />\n//                       </div>\n//                     </div>\n//                   )}\n//                 </ToolkitProvider>\n//               </CardBody>\n//             </Card>\n//           </div>\n//         </Row>\n//       </Container>\n//       {/* <AddClientModal isOpen={modal} toggle={toggleModal} onSave={addNewClient} /> */}\n//     </>\n//   );\n// };\n// export default Tables;\n\nvar _c;\n\n$RefreshReg$(_c, \"Tables\");","map":{"version":3,"sources":["C:/Users/Esther Elbaz/Desktop/Projet Code/Ouieqare-MERN - Copie/front-end/src/views/examples/Clients.js"],"names":["useHistory","React","useState","useRef","useEffect","Modal","ModalHeader","ModalBody","ModalFooter","Button","CardBody","Card","CardHeader","Container","Row","useDropzone","BootstrapTable","paginationFactory","ToolkitProvider","Search","Header","formatDate","isoString","date","Date","toLocaleDateString","selectRow","mode","clickToSelect","style","backgroundColor","onSelect","row","isSelect","rowIndex","e","console","log","id","onSelectAll","rows","Tables","history","clients","setClients","totalClients","setTotalClients","componentRef","modal","setModal","toggleModal","isUploading","uploadSuccess","setSelectedFile","setUploadError","setIsUploading","setUploadSuccess","uploadError","selectedFile","selected","setSelected","handleSelectAll","isSelectAll","ids","map","client","fetchClients","token","localStorage","getItem","error","cleanToken","trim","formattedToken","replace","fetch","headers","then","response","ok","Error","status","json","data","length","catch","err","message","handleAddClient","push","columns","dataField","text","hidden","formatter","cellContent","dateNaissance","cell","handleEditClient","handleDeleteClient","_id","pathname","state","clientId","window","confirm","method","success","prevClients","filter","prevTotal","handleFileUpload","formData","FormData","append","body","pagination","page","alwaysShowAllBtns","withFirstAndLast","sizePerPageRenderer","options","currSizePerPage","onSizePerPageChange","target","value","SearchBar","onDrop","acceptedFiles","getRootProps","getInputProps","isDragActive","sendGroupEmail","selectedClients","includes","email","marginRight","props","searchProps","border","overflowX","baseProps","className","padding","textAlign"],"mappings":"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,WAAd;AAA0B,IAAA,OAAO,EAAER,WAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAJA,CAlBE,CAlCF,CADF;AAkEC,CAlTD;;GAAMT,M;UAGYzC,U,EA8NoCe,W;;;KAjOhD0B,M;AAsTN,eAAeA,MAAf,C,CAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA","sourcesContent":["import { useHistory } from \"react-router-dom\";\r\nimport React, { useState, useRef, useEffect } from \"react\";\r\nimport {\r\n  Modal, ModalHeader, ModalBody, ModalFooter,\r\n  Button,\r\n  //ButtonGroup,\r\n  CardBody,\r\n  Card,\r\n  //Col,\r\n  CardHeader,\r\n  Container,\r\n  Row,\r\n} from \"reactstrap\";\r\n//import ReactToPrint from \"react-to-print\";\r\nimport { useDropzone } from 'react-dropzone';\r\nimport BootstrapTable from \"react-bootstrap-table-next\";\r\nimport paginationFactory from \"react-bootstrap-table2-paginator\";\r\nimport ToolkitProvider, { Search } from \"react-bootstrap-table2-toolkit\";\r\nimport Header from \"components/Headers/Header.js\";\r\nimport 'react-bootstrap-table-next/dist/react-bootstrap-table2.min.css';\r\n\r\nconst formatDate = (isoString) => {\r\n  if (!isoString) return '';\r\n  const date = new Date(isoString);\r\n  return date.toLocaleDateString('fr-FR');  // ou 'en-US' selon le format local que vous préférez\r\n}\r\n\r\nconst selectRow = {\r\n  mode: 'checkbox',\r\n  clickToSelect: true,\r\n  style: { backgroundColor: '#c8e6c9' },\r\n  onSelect: (row, isSelect, rowIndex, e) => {\r\n    console.log(row.id + \" selected: \" + isSelect);\r\n  },\r\n  onSelectAll: (isSelect, rows, e) => {\r\n    console.log(\"Select all: \" + isSelect);\r\n  }\r\n};\r\n\r\nconst Tables = () => {\r\n  //const [modal, setModal] = useState(false);\r\n  //const toggleModal = () => setModal(!modal);\r\n  const history = useHistory();\r\n  const [clients, setClients] = useState([]);\r\n  const [totalClients, setTotalClients] = useState(0);\r\n  const componentRef = useRef(null);\r\n  //const inputFileRef = useRef(null);\r\n  const [modal, setModal] = useState(false);\r\n  const toggleModal = () => {\r\n    setModal(!modal);\r\n    if (!modal) { // Si le modal va être ouvert, ne réinitialisez pas\r\n      // Réinitialisez tout seulement si le modal est fermé sans importer\r\n      if (!isUploading && !uploadSuccess) {\r\n        setSelectedFile(null);\r\n        setUploadError(\"\");\r\n      }\r\n    }\r\n  };\r\n  \r\n  \r\nconst [isUploading, setIsUploading] = useState(false);\r\nconst [uploadSuccess, setUploadSuccess] = useState(false);\r\nconst [uploadError, setUploadError] = useState(\"\");\r\nconst [selectedFile, setSelectedFile] = useState(null);\r\n\r\nconst [selected, setSelected] = useState([]);\r\n\r\nconst handleSelectAll = (isSelectAll) => {\r\n  if (isSelectAll) {\r\n    const ids = clients.map(client => client.id);\r\n    setSelected(ids);\r\n  } else {\r\n    setSelected([]);\r\n  }\r\n};\r\n\r\n// Ajoutez cette option à votre `selectRow`:\r\nselectRow.onSelectAll = (isSelect, rows, e) => {\r\n  if (isSelect) {\r\n    handleSelectAll(true);\r\n  } else {\r\n    handleSelectAll(false);\r\n  }\r\n};\r\n\r\n\r\n\r\n\r\n\r\nconst fetchClients = (setClients) => { // Pass setClients as a parameter\r\n  const token = localStorage.getItem('token');\r\n  if (!token) {\r\n      console.error('Token not found in localStorage');\r\n      return;\r\n  }\r\n\r\n  const cleanToken = token.trim();\r\n  const formattedToken = cleanToken.replace('JWT ', '');\r\n\r\n  console.log(\"Formatted Token from localStorage:\", formattedToken);\r\n\r\n  fetch('http://localhost:5100/api/clients', {\r\n      headers: {\r\n          'Authorization': `Bearer ${formattedToken}`\r\n      }\r\n  })\r\n  .then(response => {\r\n      if (!response.ok) {\r\n          throw new Error(`HTTP status ${response.status}`);\r\n      }\r\n      return response.json();\r\n  })\r\n  .then(data => {\r\n      console.log('Clients fetched:', data);\r\n      setClients(data); // Ensure this line is uncommented and correctly used\r\n      setTotalClients(data.length);\r\n  })\r\n  .catch(err => {\r\n      console.error('Error fetching clients:', err.message);\r\n  });\r\n};\r\nconst handleAddClient = () => {\r\n  console.log('Redirection to /admin/nouveauClient');\r\n    history.push('/admin/nouveauClient');\r\n  };\r\n\r\n  const columns = [\r\n    { dataField: \"id\", text: \"ID\", hidden: true },\r\n    { dataField: \"nom\", text: \"Nom\" },\r\n    { dataField: \"prenom\", text: \"Prénom\" },\r\n    { dataField: \"email\", text: \"Email\" },\r\n    { dataField: \"telephonePortable\", text: \"Téléphone Portable\" },\r\n    { dataField: \"ville\", text: \"Ville\" },\r\n    {\r\n      dataField: \"dateNaissance\",\r\n      text: \"Date de Naissance\",\r\n      formatter: (cellContent, row) => {\r\n        return formatDate(row.dateNaissance);  // Formate la date avant de l'afficher\r\n      }\r\n    },\r\n    {\r\n      dataField: 'actions',\r\n      text: 'Actions',\r\n      formatter: (cell, row) => {\r\n        return (\r\n          <div>\r\n            <Button color=\"primary\" size=\"sm\" onClick={() => handleEditClient(row)}>\r\n              <i className=\"fas fa-pencil-alt\" />\r\n            </Button>\r\n            {' '}\r\n            <Button color=\"danger\" size=\"sm\" onClick={() => handleDeleteClient(row._id)}>\r\n              <i className=\"fas fa-trash\" />\r\n            </Button>\r\n          </div>\r\n        );\r\n      }\r\n    }\r\n  ];\r\n  \r\n  // Fonction pour gérer la modification des clients\r\n  const handleEditClient = (client) => {\r\n    history.push({\r\n      pathname: '/admin/nouveauClient',\r\n      state: { client: client }\r\n    });\r\n  };\r\n  \r\n  // Fonction pour gérer la suppression des clients\r\n  const handleDeleteClient = (clientId) => {\r\n    if (window.confirm(\"Êtes-vous sûr de vouloir supprimer ce client ?\")) {\r\n      fetch(`http://localhost:5100/api/clients/${clientId}`, {\r\n        method: 'DELETE',\r\n        headers: {\r\n          'Authorization': `Bearer ${localStorage.getItem('token').trim().replace('JWT ', '')}`\r\n        }\r\n      })\r\n      .then(response => {\r\n        if (!response.ok) {\r\n          throw new Error('Failed to delete client');\r\n        }\r\n        return response.json();  // Assurez-vous que le serveur renvoie une réponse JSON\r\n      })\r\n      .then(data => {\r\n        if (data.success) {\r\n          setClients(prevClients => prevClients.filter(client => client._id !== clientId));\r\n    setTotalClients(prevTotal => prevTotal - 1);\r\n          // ou utilisez une autre méthode de mise à jour de l'état si vous utilisez un autre état global comme Redux\r\n        } else {\r\n          console.error('Failed to delete client:', data.message);\r\n        }\r\n      })\r\n      .catch(error => console.error('Error:', error));\r\n    }\r\n  };\r\n  \r\n  const handleFileUpload = () => {\r\n    if (!selectedFile) return;\r\n  \r\n    setIsUploading(true);\r\n    const formData = new FormData();\r\n    formData.append('file', selectedFile);\r\n  \r\n    fetch('http://localhost:5100/api/clients/import', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Authorization': `Bearer ${localStorage.getItem('token').trim().replace('JWT ', '')}`\r\n      },\r\n      body: formData\r\n    })\r\n    .then(response => {\r\n      if (!response.ok) {\r\n        throw new Error('Échec de l\\'importation');\r\n      }\r\n      return response.json();\r\n    })\r\n    .then(data => {\r\n      console.log(\"Import success:\", data);\r\n      fetchClients(setClients);  // Refresh the client list after import\r\n      setIsUploading(false);\r\n      setUploadSuccess(true);\r\n      setSelectedFile(null); // Clear file after upload\r\n    })\r\n    .catch(err => {\r\n      console.error(\"Import error:\", err);\r\n      setIsUploading(false);\r\n      setUploadError(\"Erreur lors de l'importation: \" + err.message);\r\n    });\r\n  };\r\n\r\n  \r\n  \r\n\r\n  const pagination = paginationFactory({\r\n    page: 1,\r\n    alwaysShowAllBtns: true,\r\n    //showTotal: true,\r\n    withFirstAndLast: false,\r\n    sizePerPageRenderer: ({ options, currSizePerPage, onSizePerPageChange }) => (\r\n      <div className=\"dataTables_length\" id=\"datatable-basic_length\">\r\n        <label>\r\n          {\" \"}\r\n          {\r\n            <select\r\n              name=\"datatable-basic_length\"\r\n              aria-controls=\"datatable-basic\"\r\n              className=\"form-control form-control-sm\"\r\n              onChange={e => onSizePerPageChange(e.target.value)}\r\n            >\r\n              <option value=\"10\">10</option>\r\n              <option value=\"25\">25</option>\r\n              <option value=\"50\">50</option>\r\n              <option value=\"100\">100</option>\r\n            </select>\r\n          }{\" \"}\r\n          \r\n        </label>\r\n      </div>\r\n    )\r\n  });\r\n\r\n  const { SearchBar } = Search;\r\n  useEffect(() => {\r\n    fetchClients(setClients); // Pass setClients here\r\n}, []); \r\nconst { getRootProps, getInputProps, isDragActive } = useDropzone({\r\n  onDrop: acceptedFiles => {\r\n    console.log(acceptedFiles);\r\n    setSelectedFile(acceptedFiles[0]); // Assurez-vous que c'est bien un fichier\r\n    setUploadSuccess(false);\r\n    setUploadError(\"\");\r\n  }\r\n});\r\n\r\nconst sendGroupEmail = () => {\r\n  const selectedClients = clients.filter(client => selected.includes(client.id));\r\n  console.log(\"Envoi d'e-mails à:\", selectedClients.map(client => client.email));\r\n  // Ici, vous ajouterez votre logique d'envoi de mails\r\n};\r\n\r\nreturn (\r\n  <>\r\n    <Header />\r\n    <Container className=\"mt--7\" fluid>\r\n      <Row>\r\n        <div className=\"col\">\r\n          <Card className=\"shadow\">\r\n          <CardHeader className=\"border-0 d-flex align-items-center justify-content-between\">\r\n  <div>\r\n    <h3 className=\"mb-0\">Clients (Total : {totalClients})</h3>\r\n  </div>\r\n  <div>\r\n    <Button color=\"primary\" onClick={handleAddClient} style={{ marginRight: '10px' }}>Ajouter Client</Button>\r\n    <Button color=\"info\" onClick={toggleModal}>Importer Clients</Button>\r\n    <Button color=\"info\" onClick={sendGroupEmail}>Envoyer Mail</Button>\r\n  </div>\r\n</CardHeader>\r\n\r\n\r\n            <CardBody>\r\n              <ToolkitProvider keyField=\"id\" data={clients} columns={columns} search>\r\n                {props => (\r\n                  <div>\r\n                    <SearchBar {...props.searchProps} style={{ border: '1px solid black' }} />\r\n                    <div style={{ overflowX: 'auto' }}>\r\n                      <BootstrapTable {...props.baseProps} ref={componentRef} bootstrap4 pagination={pagination} bordered={false} />\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </ToolkitProvider>\r\n            </CardBody>\r\n          </Card>\r\n        </div>\r\n      </Row>\r\n    </Container>\r\n    <Modal isOpen={modal} toggle={toggleModal}>\r\n  <ModalHeader toggle={toggleModal}>Importer des fichiers</ModalHeader>\r\n  <ModalBody>\r\n    <div {...getRootProps({ className: 'dropzone' })} style={{ border: '2px dashed #007bff', padding: '20px', textAlign: 'center' }}>\r\n      <input {...getInputProps()} />\r\n      <i className=\"fas fa-file-upload fa-2x\"></i> {/* Icone de FontAwesome */}\r\n      {/* <p>Glissez-déposez des fichiers ici, ou cliquez pour sélectionner des fichiers.</p> */}\r\n      <p>Formats supportés : .csv, .xlsx</p>\r\n      {isDragActive ? (\r\n        <p>Relâchez le fichier ici...</p>\r\n      ) : (\r\n        <p>Glissez-déposez des fichiers ici, ou cliquez pour sélectionner des fichiers</p>\r\n      )}\r\n      {isUploading && <div>Chargement...</div>}\r\n      {uploadSuccess && <div className=\"alert alert-success\">Fichier importé avec succès!</div>}\r\n      {uploadError && <div className=\"alert alert-danger\">{uploadError}</div>}\r\n    </div>\r\n  </ModalBody>\r\n  <ModalFooter>\r\n  <Button color=\"primary\" onClick={handleFileUpload} disabled={!selectedFile}>\r\n    OK\r\n  </Button>\r\n  <Button color=\"secondary\" onClick={toggleModal}>Fermer</Button>\r\n</ModalFooter>\r\n\r\n</Modal>\r\n\r\n\r\n  </>\r\n);\r\n\r\n};\r\n\r\n\r\n\r\nexport default Tables;\r\n\r\n\r\n// import { useHistory } from \"react-router-dom\";\r\n// import React, { useState, useRef, useEffect } from \"react\";\r\n// import {\r\n//   Button,\r\n//   //ButtonGroup,\r\n//   CardBody,\r\n//   Card,\r\n//   //Col,\r\n//   CardHeader,\r\n//   Container,\r\n//   Row,\r\n// } from \"reactstrap\";\r\n// //import ReactToPrint from \"react-to-print\";\r\n// import BootstrapTable from \"react-bootstrap-table-next\";\r\n// import paginationFactory from \"react-bootstrap-table2-paginator\";\r\n// import ToolkitProvider, { Search } from \"react-bootstrap-table2-toolkit\";\r\n// //import ReactBSAlert from \"react-bootstrap-sweetalert\";\r\n// import Header from \"components/Headers/Header.js\";\r\n// //import { dataTable } from \"variables/general\";\r\n\r\n// const formatDate = (isoString) => {\r\n//   if (!isoString) return '';\r\n//   const date = new Date(isoString);\r\n//   return date.toLocaleDateString('fr-FR');  // ou 'en-US' selon le format local que vous préférez\r\n// }\r\n\r\n\r\n// const fetchClients = (setClients) => { // Pass setClients as a parameter\r\n//   const token = localStorage.getItem('token');\r\n//   if (!token) {\r\n//       console.error('Token not found in localStorage');\r\n//       return;\r\n//   }\r\n\r\n//   const cleanToken = token.trim();\r\n//   const formattedToken = cleanToken.replace('JWT ', '');\r\n\r\n//   console.log(\"Formatted Token from localStorage:\", formattedToken);\r\n\r\n//   fetch('http://localhost:5100/api/clients', {\r\n//       headers: {\r\n//           'Authorization': Bearer ${formattedToken}\r\n//       }\r\n//   })\r\n//   .then(response => {\r\n//       if (!response.ok) {\r\n//           throw new Error(HTTP status ${response.status});\r\n//       }\r\n//       return response.json();\r\n//   })\r\n//   .then(data => {\r\n//       console.log('Clients fetched:', data);\r\n//       setClients(data); // Ensure this line is uncommented and correctly used\r\n//   })\r\n//   .catch(err => {\r\n//       console.error('Error fetching clients:', err.message);\r\n//   });\r\n// };\r\n\r\n\r\n// const Tables = () => {\r\n//   //const [modal, setModal] = useState(false);\r\n//   //const toggleModal = () => setModal(!modal);\r\n//   const history = useHistory();\r\n//   const [clients, setClients] = useState([]);\r\n//   const componentRef = useRef(null);\r\n//   const inputFileRef = useRef(null);\r\n\r\n\r\n  \r\n// const handleAddClient = () => {\r\n//   console.log('Redirection to /admin/nouveauClient');\r\n//     history.push('/admin/nouveauClient');\r\n//   };\r\n\r\n//   const columns = [\r\n//     { dataField: \"id\", text: \"ID\", hidden: true },\r\n//     { dataField: \"nom\", text: \"Nom\" },\r\n//     { dataField: \"prenom\", text: \"Prénom\" },\r\n//     { dataField: \"email\", text: \"Email\" },\r\n//     { dataField: \"telephonePortable\", text: \"Téléphone Portable\" },\r\n//     { dataField: \"ville\", text: \"Ville\" },\r\n//     {\r\n//       dataField: \"dateNaissance\",\r\n//       text: \"Date de Naissance\",\r\n//       formatter: (cellContent, row) => {\r\n//         return formatDate(row.dateNaissance);  // Formate la date avant de l'afficher\r\n//       }\r\n//     },\r\n//     {\r\n//       dataField: 'actions',\r\n//       text: 'Actions',\r\n//       formatter: (cell, row) => {\r\n//         return (\r\n//           <div>\r\n//             <Button color=\"primary\" size=\"sm\" onClick={() => handleEditClient(row)}>\r\n//               <i className=\"fas fa-pencil-alt\" />\r\n//             </Button>\r\n//             {' '}\r\n//             <Button color=\"danger\" size=\"sm\" onClick={() => handleDeleteClient(row._id)}>\r\n//               <i className=\"fas fa-trash\" />\r\n//             </Button>\r\n//           </div>\r\n//         );\r\n//       }\r\n//     }\r\n//   ];\r\n  \r\n//   // Fonction pour gérer la modification des clients\r\n//   const handleEditClient = (client) => {\r\n//     history.push({\r\n//       pathname: '/admin/nouveauClient',\r\n//       state: { client: client }\r\n//     });\r\n//   };\r\n  \r\n//   // Fonction pour gérer la suppression des clients\r\n//   const handleDeleteClient = (clientId) => {\r\n//     if (window.confirm(\"Êtes-vous sûr de vouloir supprimer ce client ?\")) {\r\n//       fetch(http://localhost:5100/api/clients/${clientId}, {\r\n//         method: 'DELETE',\r\n//         headers: {\r\n//           'Authorization': Bearer ${localStorage.getItem('token').trim().replace('JWT ', '')}\r\n//         }\r\n//       })\r\n//       .then(response => {\r\n//         if (!response.ok) {\r\n//           throw new Error('Failed to delete client');\r\n//         }\r\n//         return response.json();  // Assurez-vous que le serveur renvoie une réponse JSON\r\n//       })\r\n//       .then(data => {\r\n//         if (data.success) {\r\n//           setClients(prevClients => prevClients.filter(client => client._id !== clientId));\r\n//           // ou utilisez une autre méthode de mise à jour de l'état si vous utilisez un autre état global comme Redux\r\n//         } else {\r\n//           console.error('Failed to delete client:', data.message);\r\n//         }\r\n//       })\r\n//       .catch(error => console.error('Error:', error));\r\n//     }\r\n//   };\r\n\r\n//   // const handleFileUpload = (event) => {\r\n//   //   const file = event.target.files[0];\r\n//   //   if (file) {\r\n//   //     const reader = new FileReader();\r\n//   //     reader.onload = (e) => {\r\n//   //       const text = e.target.result;\r\n//   //       // Convertir CSV en JSON ici ou envoyer le texte brut au serveur pour traitement\r\n//   //       uploadData(text);\r\n//   //     };\r\n//   //     reader.readAsText(file);\r\n//   //   }\r\n//   // };\r\n  \r\n//   // const uploadData = (data) => {\r\n//   //   fetch('http://localhost:5100/api/clients/import', {\r\n//   //     method: 'POST',\r\n//   //     headers: {\r\n//   //       'Content-Type': 'application/json',\r\n//   //       'Authorization': Bearer ${localStorage.getItem('token').trim().replace('JWT ', '')}\r\n//   //     },\r\n//   //     body: JSON.stringify({ data })\r\n//   //   })\r\n//   //   .then(response => response.json())\r\n//   //   .then(data => {\r\n//   //     console.log(\"Import success:\", data);\r\n//   //     fetchClients(setClients);  // Rafraîchir la liste des clients après l'import\r\n//   //   })\r\n//   //   .catch(err => console.error(\"Import error:\", err));\r\n//   // };\r\n  \r\n//   // // Ajouter un bouton et input dans le JSX\r\n  \r\n//   const handleFileUpload = (event) => {\r\n//     const file = event.target.files[0];\r\n//     if (!file) return;\r\n\r\n//     const formData = new FormData();\r\n//     formData.append('file', file);\r\n\r\n//     fetch('http://localhost:5100/api/clients/import', {\r\n//         method: 'POST',\r\n//         headers: {\r\n//           'Authorization': Bearer ${localStorage.getItem('token').trim().replace('JWT ', '')}\r\n//         },\r\n//         body: formData\r\n//     })\r\n//     .then(response => response.json())\r\n//     .then(data => {\r\n//         console.log(\"Import success:\", data);\r\n//         fetchClients(setClients);  // Refresh the client list after import\r\n//     })\r\n//     .catch(err => console.error(\"Import error:\", err));\r\n// };\r\n\r\n//   const pagination = paginationFactory({\r\n//     page: 1,\r\n//     alwaysShowAllBtns: true,\r\n//     //showTotal: true,\r\n//     withFirstAndLast: false,\r\n//     sizePerPageRenderer: ({ options, currSizePerPage, onSizePerPageChange }) => (\r\n//       <div className=\"dataTables_length\" id=\"datatable-basic_length\">\r\n//         <label>\r\n//           {\" \"}\r\n//           {\r\n//             <select\r\n//               name=\"datatable-basic_length\"\r\n//               aria-controls=\"datatable-basic\"\r\n//               className=\"form-control form-control-sm\"\r\n//               onChange={e => onSizePerPageChange(e.target.value)}\r\n//             >\r\n//               <option value=\"10\">10</option>\r\n//               <option value=\"25\">25</option>\r\n//               <option value=\"50\">50</option>\r\n//               <option value=\"100\">100</option>\r\n//             </select>\r\n//           }{\" \"}\r\n          \r\n//         </label>\r\n//       </div>\r\n//     )\r\n//   });\r\n\r\n//   const { SearchBar } = Search;\r\n//   useEffect(() => {\r\n//     fetchClients(setClients); // Pass setClients here\r\n// }, []); \r\n\r\n\r\n//   return (\r\n//     <>\r\n//       <Header />\r\n//       <Container className=\"mt--7\" fluid>\r\n//         <Row>\r\n//           <div className=\"col\">\r\n//             <Card className=\"shadow\">\r\n//               <CardHeader className=\"border-0 d-flex align-items-center justify-content-between\">\r\n//                 <h3 className=\"mb-0\">Clients</h3>\r\n//                 <input type=\"file\" onChange={handleFileUpload} accept=\".csv\" style={{ display: 'none' }} ref={inputFileRef} />\r\n// <Button color=\"info\" onClick={() => inputFileRef.current && inputFileRef.current.click()}>\r\n//   Importer Clients\r\n// </Button>\r\n//                 {/* <Button color=\"primary\" onClick={toggleModal}>Ajouter Client</Button> */}\r\n//                 <Button color=\"primary\" onClick={handleAddClient}>Ajouter Client</Button>\r\n//               </CardHeader>\r\n              \r\n//               <CardBody>\r\n                \r\n//                 <ToolkitProvider\r\n//                   keyField=\"id\"\r\n//                   data={clients}\r\n//                   columns={columns}\r\n//                   search\r\n//                 >\r\n//                   {props => (\r\n//                     <div>\r\n                      \r\n//                       <SearchBar {...props.searchProps} style={{ border: '1px solid black' }} />\r\n//                       <div style={{ overflowX: 'auto' }}>\r\n//                         <BootstrapTable\r\n//                           {...props.baseProps}\r\n//                           ref={componentRef}\r\n//                           bootstrap4\r\n//                           pagination={pagination}\r\n//                           bordered={false}\r\n//                         />\r\n//                       </div>\r\n//                     </div>\r\n//                   )}\r\n//                 </ToolkitProvider>\r\n//               </CardBody>\r\n//             </Card>\r\n//           </div>\r\n//         </Row>\r\n//       </Container>\r\n//       {/* <AddClientModal isOpen={modal} toggle={toggleModal} onSave={addNewClient} /> */}\r\n//     </>\r\n//   );\r\n// };\r\n\r\n\r\n\r\n// export default Tables;"]},"metadata":{},"sourceType":"module"}