{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/esthe/OneDrive/Desktop/Projet Code/Ouieqare-MERN - Copie/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _createForOfIteratorHelper from \"C:/Users/esthe/OneDrive/Desktop/Projet Code/Ouieqare-MERN - Copie/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nimport _asyncToGenerator from \"C:/Users/esthe/OneDrive/Desktop/Projet Code/Ouieqare-MERN - Copie/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"C:/Users/esthe/OneDrive/Desktop/Projet Code/Ouieqare-MERN - Copie/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"C:/Users/esthe/OneDrive/Desktop/Projet Code/Ouieqare-MERN - Copie/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\esthe\\\\OneDrive\\\\Desktop\\\\Projet Code\\\\Ouieqare-MERN - Copie\\\\front-end\\\\src\\\\views\\\\examples\\\\Corbeille.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { ToastContainer, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport { Button, CardBody, Card, CardHeader, Container, Row } from \"reactstrap\";\nimport BootstrapTable from \"react-bootstrap-table-next\";\nimport paginationFactory from \"react-bootstrap-table2-paginator\";\nimport ToolkitProvider, { Search } from \"react-bootstrap-table2-toolkit\";\nimport Header from \"components/Headers/Header.js\";\nimport 'react-bootstrap-table-next/dist/react-bootstrap-table2.min.css';\n\nvar Corbeille = function Corbeille() {\n  _s();\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      clients = _useState2[0],\n      setClients = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      totalClients = _useState4[0],\n      setTotalClients = _useState4[1];\n\n  var SearchBar = Search.SearchBar;\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      selected = _useState6[0],\n      setSelected = _useState6[1];\n\n  var handleOnSelect = function handleOnSelect(row, isSelect) {\n    console.log(\"Select \".concat(isSelect ? 'on' : 'off', \" for row id \").concat(row._id));\n\n    if (isSelect) {\n      setSelected(function (prevSelected) {\n        var newSelected = [].concat(_toConsumableArray(prevSelected), [row._id]);\n        console.log('New selected after add:', newSelected);\n        return newSelected;\n      });\n    } else {\n      setSelected(function (prevSelected) {\n        var newSelected = prevSelected.filter(function (x) {\n          return x !== row._id;\n        });\n        console.log('New selected after remove:', newSelected);\n        return newSelected;\n      });\n    }\n  };\n\n  var handleOnSelectAll = function handleOnSelectAll(isSelect, rows) {\n    console.log(\"Select all \".concat(isSelect ? 'on' : 'off'));\n\n    if (isSelect) {\n      var idsToSelect = rows.map(function (r) {\n        return r._id;\n      });\n      console.log('Selecting all ids:', idsToSelect);\n      setSelected(idsToSelect);\n    } else {\n      setSelected([]);\n    }\n  };\n\n  var selectAllRenderer = function selectAllRenderer(_ref) {\n    var mode = _ref.mode,\n        checked = _ref.checked,\n        indeterminate = _ref.indeterminate;\n    return /*#__PURE__*/React.createElement(\"input\", {\n      type: mode,\n      checked: checked,\n      ref: function ref(input) {\n        if (input) input.indeterminate = indeterminate;\n      },\n      onChange: function onChange(e) {\n        handleOnSelectAll(e.target.checked, clients); // Appelez handleOnSelectAll avec le bon contexte\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 5\n      }\n    });\n  };\n\n  var handleDeleteSelected = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _iterator, _step, _loop, newClients;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!window.confirm(\"Êtes-vous sûr de vouloir supprimer les clients sélectionnés ?\")) {\n                _context2.next = 20;\n                break;\n              }\n\n              _iterator = _createForOfIteratorHelper(selected);\n              _context2.prev = 2;\n              _loop = /*#__PURE__*/_regeneratorRuntime.mark(function _loop() {\n                var clientId;\n                return _regeneratorRuntime.wrap(function _loop$(_context) {\n                  while (1) {\n                    switch (_context.prev = _context.next) {\n                      case 0:\n                        clientId = _step.value;\n                        _context.next = 3;\n                        return fetch(\"http://localhost:5100/api/clients/\".concat(clientId), {\n                          method: 'DELETE',\n                          headers: {\n                            'Authorization': \"Bearer \".concat(localStorage.getItem('token').trim().replace('JWT ', ''))\n                          }\n                        }).then(function (response) {\n                          if (!response.ok) {\n                            throw new Error(\"Failed to delete client \".concat(clientId, \", status: \").concat(response.status));\n                          }\n\n                          return response.json();\n                        }).then(function (data) {\n                          if (!data.success) {\n                            throw new Error(data.message);\n                          }\n\n                          setTotalClients(function (prevTotal) {\n                            return prevTotal - 1;\n                          });\n                          toast.success(\"Client supprim\\xE9 avec succ\\xE8s!\");\n                        }).catch(function (error) {\n                          console.error('Error:', error);\n                          toast.error(\"Error deleting client \".concat(clientId, \": \").concat(error.message));\n                        });\n\n                      case 3:\n                      case \"end\":\n                        return _context.stop();\n                    }\n                  }\n                }, _loop);\n              });\n\n              _iterator.s();\n\n            case 5:\n              if ((_step = _iterator.n()).done) {\n                _context2.next = 9;\n                break;\n              }\n\n              return _context2.delegateYield(_loop(), \"t0\", 7);\n\n            case 7:\n              _context2.next = 5;\n              break;\n\n            case 9:\n              _context2.next = 14;\n              break;\n\n            case 11:\n              _context2.prev = 11;\n              _context2.t1 = _context2[\"catch\"](2);\n\n              _iterator.e(_context2.t1);\n\n            case 14:\n              _context2.prev = 14;\n\n              _iterator.f();\n\n              return _context2.finish(14);\n\n            case 17:\n              // Mise à jour de l'état après la suppression de tous les clients sélectionnés\n              newClients = clients.filter(function (client) {\n                return !selected.includes(client._id);\n              });\n              setClients(newClients);\n              setSelected([]);\n\n            case 20:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee, null, [[2, 11, 14, 17]]);\n    }));\n\n    return function handleDeleteSelected() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var deleteButton = selected.length > 0 ? /*#__PURE__*/React.createElement(Button, {\n    color: \"danger\",\n    onClick: handleDeleteSelected,\n    style: {\n      marginLeft: '10px'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 5\n    }\n  }, \"Supprimer la s\\xE9lection\") : null;\n  var selectRow = {\n    mode: 'checkbox',\n    clickToSelect: true,\n    selected: selected,\n    onSelect: handleOnSelect,\n    onSelectAll: handleOnSelectAll,\n    selectionHeaderRenderer: selectAllRenderer,\n    style: {\n      backgroundColor: '#c8e6c9'\n    }\n  };\n  useEffect(function () {\n    fetchDeletedClients();\n  }, []);\n\n  var fetchDeletedClients = function fetchDeletedClients() {\n    var token = localStorage.getItem('token');\n\n    if (!token) {\n      console.error('Token not found in localStorage');\n      return;\n    }\n\n    var cleanToken = token.trim();\n    var formattedToken = cleanToken.replace('JWT ', '');\n    console.log(\"Formatted Token from localStorage:\", formattedToken);\n    fetch('http://localhost:5100/api/clients/deleted', {\n      headers: {\n        'Authorization': \"Bearer \".concat(formattedToken)\n      }\n    }).then(function (response) {\n      if (!response.ok) {\n        throw new Error(\"HTTP status \".concat(response.status));\n      }\n\n      return response.json();\n    }).then(function (data) {\n      console.log('Deleted clients fetched:', data);\n      setClients(data); // Ceci met à jour l'état avec les données récupérées\n\n      setTotalClients(data.length);\n    }).catch(function (err) {\n      console.error('Error fetching clients:', err.message);\n    });\n  }; // Définition des colonnes du tableau\n\n\n  var columns = [{\n    dataField: \"_id\",\n    text: \"ID\",\n    hidden: true\n  }, {\n    dataField: \"nom\",\n    text: \"Nom\"\n  }, {\n    dataField: \"prenom\",\n    text: \"Prénom\"\n  }, {\n    dataField: \"email\",\n    text: \"Email\"\n  }, {\n    dataField: \"actions\",\n    text: \"Actions\",\n    formatter: function formatter(cellContent, row) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        color: \"success\",\n        size: \"sm\",\n        onClick: function onClick() {\n          return restoreClient(row._id);\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 11\n        }\n      }, \"Restaurer\"), ' ', /*#__PURE__*/React.createElement(Button, {\n        color: \"danger\",\n        size: \"sm\",\n        onClick: function onClick() {\n          return deleteClient(row._id);\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fas fa-trash\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 13\n        }\n      })));\n    }\n  }];\n\n  var restoreClient = function restoreClient(clientId) {\n    var token = localStorage.getItem('token');\n\n    if (!token) {\n      console.error('Token not found in localStorage');\n      return;\n    }\n\n    var cleanToken = token.trim();\n    var formattedToken = cleanToken.replace('JWT ', '');\n    fetch(\"http://localhost:5100/api/clients/restore/\".concat(clientId), {\n      method: 'PUT',\n      headers: {\n        'Authorization': \"Bearer \".concat(formattedToken),\n        'Content-Type': 'application/json'\n      }\n    }).then(function (response) {\n      if (!response.ok) {\n        throw new Error(\"HTTP status \".concat(response.status));\n      }\n\n      return response.json();\n    }).then(function (data) {\n      if (data.success) {\n        setTotalClients(function (prevTotal) {\n          return prevTotal - 1;\n        });\n        toast.success(\"Client restauré avec succés !\");\n        setClients(function (currentClients) {\n          return currentClients.filter(function (client) {\n            return client._id !== clientId;\n          });\n        });\n      } else {\n        throw new Error(data.message);\n      }\n    }).catch(function (error) {\n      console.error('Error:', error);\n      toast.error(\"Error: \".concat(error.message));\n    });\n  };\n\n  var deleteClient = function deleteClient(clientId) {\n    var token = localStorage.getItem('token');\n\n    if (!token) {\n      console.error('Token not found in localStorage');\n      return;\n    }\n\n    var cleanToken = token.trim();\n    var formattedToken = cleanToken.replace('JWT ', '');\n    fetch(\"http://localhost:5100/api/clients/deletedef/\".concat(clientId), {\n      method: 'DELETE',\n      headers: {\n        'Authorization': \"Bearer \".concat(formattedToken),\n        'Content-Type': 'application/json'\n      }\n    }).then(function (response) {\n      if (!response.ok) {\n        throw new Error(\"HTTP status \".concat(response.status));\n      }\n\n      return response.json();\n    }).then(function (data) {\n      if (data.success) {\n        toast.success(\"Client supprimé avec succès!\");\n        setTotalClients(function (prevTotal) {\n          return prevTotal - 1;\n        });\n        setClients(function (currentClients) {\n          return currentClients.filter(function (client) {\n            return client._id !== clientId;\n          });\n        });\n      } else {\n        throw new Error(data.message);\n      }\n    }).catch(function (error) {\n      console.error('Error:', error);\n      toast.error(\"Error: \".concat(error.message));\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Header, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(Container, {\n    className: \"mt--7\",\n    fluid: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(ToastContainer, {\n    position: \"bottom-right\",\n    autoClose: 5000,\n    hideProgressBar: false,\n    newestOnTop: false,\n    closeOnClick: true,\n    rtl: false,\n    pauseOnFocusLoss: true,\n    draggable: true,\n    pauseOnHover: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Row, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Card, {\n    className: \"shadow\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 267,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(CardHeader, {\n    className: \"border-0\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    className: \"mb-0\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 15\n    }\n  }, \"Corbeille (Total : \", totalClients, \")\")), /*#__PURE__*/React.createElement(CardBody, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(ToolkitProvider, {\n    keyField: \"_id\",\n    data: clients,\n    columns: columns,\n    search: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 13\n    }\n  }, function (props) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 281,\n        columnNumber: 21\n      }\n    }, deleteButton, /*#__PURE__*/React.createElement(SearchBar, Object.assign({}, props.searchProps, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 283,\n        columnNumber: 23\n      }\n    })), /*#__PURE__*/React.createElement(BootstrapTable, Object.assign({}, props.baseProps, {\n      bootstrap4: true,\n      pagination: paginationFactory(),\n      noDataIndication: \"Aucun client supprim\\xE9 trouv\\xE9\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 23\n      }\n    })));\n  })))))));\n};\n\n_s(Corbeille, \"2LMEfykhUgmSWc0hVXvzc3FdrqQ=\");\n\n_c = Corbeille;\nexport default Corbeille;\n\nvar _c;\n\n$RefreshReg$(_c, \"Corbeille\");","map":{"version":3,"sources":["C:/Users/esthe/OneDrive/Desktop/Projet Code/Ouieqare-MERN - Copie/front-end/src/views/examples/Corbeille.js"],"names":["React","useState","useEffect","ToastContainer","toast","Button","CardBody","Card","CardHeader","Container","Row","BootstrapTable","paginationFactory","ToolkitProvider","Search","Header","Corbeille","clients","setClients","totalClients","setTotalClients","SearchBar","selected","setSelected","handleOnSelect","row","isSelect","console","log","_id","prevSelected","newSelected","filter","x","handleOnSelectAll","rows","idsToSelect","map","r","selectAllRenderer","mode","checked","indeterminate","input","e","target","handleDeleteSelected","window","confirm","clientId","fetch","method","headers","localStorage","getItem","trim","replace","then","response","ok","Error","status","json","data","success","message","prevTotal","catch","error","newClients","client","includes","deleteButton","length","marginLeft","selectRow","clickToSelect","onSelect","onSelectAll","selectionHeaderRenderer","style","backgroundColor","fetchDeletedClients","token","cleanToken","formattedToken","err","columns","dataField","text","hidden","formatter","cellContent","restoreClient","deleteClient","currentClients","props","searchProps","baseProps"],"mappings":";;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,SAASC,cAAT,EAAyBC,KAAzB,QAAsC,gBAAtC;AACA,OAAO,uCAAP;AAEA,SACEC,MADF,EAEEC,QAFF,EAGEC,IAHF,EAIEC,UAJF,EAKEC,SALF,EAMEC,GANF,QAOO,YAPP;AAQA,OAAOC,cAAP,MAA2B,4BAA3B;AACA,OAAOC,iBAAP,MAA8B,kCAA9B;AACA,OAAOC,eAAP,IAA0BC,MAA1B,QAAwC,gCAAxC;AACA,OAAOC,MAAP,MAAmB,8BAAnB;AACA,OAAO,gEAAP;;AAGA,IAAMC,SAAS,GAAG,SAAZA,SAAY,GAAM;AAAA;;AAAA,kBACQf,QAAQ,CAAC,EAAD,CADhB;AAAA;AAAA,MACfgB,OADe;AAAA,MACNC,UADM;;AAAA,mBAEkBjB,QAAQ,CAAC,CAAD,CAF1B;AAAA;AAAA,MAEfkB,YAFe;AAAA,MAEDC,eAFC;;AAAA,MAGdC,SAHc,GAGAP,MAHA,CAGdO,SAHc;;AAAA,mBAIUpB,QAAQ,CAAC,EAAD,CAJlB;AAAA;AAAA,MAIfqB,QAJe;AAAA,MAILC,WAJK;;AAMtB,MAAMC,cAAc,GAAG,SAAjBA,cAAiB,CAACC,GAAD,EAAMC,QAAN,EAAmB;AACxCC,IAAAA,OAAO,CAACC,GAAR,kBAAsBF,QAAQ,GAAG,IAAH,GAAU,KAAxC,yBAA4DD,GAAG,CAACI,GAAhE;;AACA,QAAIH,QAAJ,EAAc;AACZH,MAAAA,WAAW,CAAC,UAAAO,YAAY,EAAI;AAC1B,YAAMC,WAAW,gCAAOD,YAAP,IAAqBL,GAAG,CAACI,GAAzB,EAAjB;AACAF,QAAAA,OAAO,CAACC,GAAR,CAAY,yBAAZ,EAAuCG,WAAvC;AACA,eAAOA,WAAP;AACD,OAJU,CAAX;AAKD,KAND,MAMO;AACLR,MAAAA,WAAW,CAAC,UAAAO,YAAY,EAAI;AAC1B,YAAMC,WAAW,GAAGD,YAAY,CAACE,MAAb,CAAoB,UAAAC,CAAC;AAAA,iBAAIA,CAAC,KAAKR,GAAG,CAACI,GAAd;AAAA,SAArB,CAApB;AACAF,QAAAA,OAAO,CAACC,GAAR,CAAY,4BAAZ,EAA0CG,WAA1C;AACA,eAAOA,WAAP;AACD,OAJU,CAAX;AAKD;AACF,GAfD;;AAiBA,MAAMG,iBAAiB,GAAG,SAApBA,iBAAoB,CAACR,QAAD,EAAWS,IAAX,EAAoB;AAC5CR,IAAAA,OAAO,CAACC,GAAR,sBAA0BF,QAAQ,GAAG,IAAH,GAAU,KAA5C;;AACA,QAAIA,QAAJ,EAAc;AACZ,UAAMU,WAAW,GAAGD,IAAI,CAACE,GAAL,CAAS,UAAAC,CAAC;AAAA,eAAIA,CAAC,CAACT,GAAN;AAAA,OAAV,CAApB;AACAF,MAAAA,OAAO,CAACC,GAAR,CAAY,oBAAZ,EAAkCQ,WAAlC;AACAb,MAAAA,WAAW,CAACa,WAAD,CAAX;AACD,KAJD,MAIO;AACLb,MAAAA,WAAW,CAAC,EAAD,CAAX;AACD;AACF,GATD;;AAYA,MAAMgB,iBAAiB,GAAG,SAApBA,iBAAoB;AAAA,QAAGC,IAAH,QAAGA,IAAH;AAAA,QAASC,OAAT,QAASA,OAAT;AAAA,QAAkBC,aAAlB,QAAkBA,aAAlB;AAAA,wBACxB;AACE,MAAA,IAAI,EAAEF,IADR;AAEE,MAAA,OAAO,EAAEC,OAFX;AAGE,MAAA,GAAG,EAAE,aAAAE,KAAK,EAAI;AACZ,YAAIA,KAAJ,EAAWA,KAAK,CAACD,aAAN,GAAsBA,aAAtB;AACZ,OALH;AAME,MAAA,QAAQ,EAAE,kBAAAE,CAAC,EAAI;AACbV,QAAAA,iBAAiB,CAACU,CAAC,CAACC,MAAF,CAASJ,OAAV,EAAmBxB,OAAnB,CAAjB,CADa,CACkC;AAChD,OARH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADwB;AAAA,GAA1B;;AAaA,MAAM6B,oBAAoB;AAAA,yEAAG;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,mBACvBC,MAAM,CAACC,OAAP,CAAe,+DAAf,CADuB;AAAA;AAAA;AAAA;;AAAA,qDAEF1B,QAFE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEd2B,wBAAAA,QAFc;AAAA;AAAA,+BAGjBC,KAAK,6CAAsCD,QAAtC,GAAkD;AAC3DE,0BAAAA,MAAM,EAAE,QADmD;AAE3DC,0BAAAA,OAAO,EAAE;AACP,8DAA2BC,YAAY,CAACC,OAAb,CAAqB,OAArB,EAA8BC,IAA9B,GAAqCC,OAArC,CAA6C,MAA7C,EAAqD,EAArD,CAA3B;AADO;AAFkD,yBAAlD,CAAL,CAMLC,IANK,CAMA,UAAAC,QAAQ,EAAI;AAChB,8BAAI,CAACA,QAAQ,CAACC,EAAd,EAAkB;AAChB,kCAAM,IAAIC,KAAJ,mCAAqCX,QAArC,uBAA0DS,QAAQ,CAACG,MAAnE,EAAN;AACD;;AACD,iCAAOH,QAAQ,CAACI,IAAT,EAAP;AACD,yBAXK,EAYLL,IAZK,CAYA,UAAAM,IAAI,EAAI;AACZ,8BAAI,CAACA,IAAI,CAACC,OAAV,EAAmB;AACjB,kCAAM,IAAIJ,KAAJ,CAAUG,IAAI,CAACE,OAAf,CAAN;AACD;;AACD7C,0BAAAA,eAAe,CAAC,UAAA8C,SAAS;AAAA,mCAAIA,SAAS,GAAG,CAAhB;AAAA,2BAAV,CAAf;AACA9D,0BAAAA,KAAK,CAAC4D,OAAN;AACD,yBAlBK,EAmBLG,KAnBK,CAmBC,UAAAC,KAAK,EAAI;AACdzC,0BAAAA,OAAO,CAACyC,KAAR,CAAc,QAAd,EAAwBA,KAAxB;AACAhE,0BAAAA,KAAK,CAACgE,KAAN,iCAAqCnB,QAArC,eAAkDmB,KAAK,CAACH,OAAxD;AACD,yBAtBK,CAHiB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;;AAAA;;AAAA;;AAAA;AA2BzB;AACMI,cAAAA,UA5BmB,GA4BNpD,OAAO,CAACe,MAAR,CAAe,UAAAsC,MAAM;AAAA,uBAAI,CAAChD,QAAQ,CAACiD,QAAT,CAAkBD,MAAM,CAACzC,GAAzB,CAAL;AAAA,eAArB,CA5BM;AA6BzBX,cAAAA,UAAU,CAACmD,UAAD,CAAV;AACA9C,cAAAA,WAAW,CAAC,EAAD,CAAX;;AA9ByB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAApBuB,oBAAoB;AAAA;AAAA;AAAA,KAA1B;;AAmCA,MAAM0B,YAAY,GAAGlD,QAAQ,CAACmD,MAAT,GAAkB,CAAlB,gBACnB,oBAAC,MAAD;AAAQ,IAAA,KAAK,EAAC,QAAd;AAAuB,IAAA,OAAO,EAAE3B,oBAAhC;AAAsD,IAAA,KAAK,EAAE;AAAE4B,MAAAA,UAAU,EAAE;AAAd,KAA7D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iCADmB,GAIjB,IAJJ;AAMA,MAAMC,SAAS,GAAG;AAChBnC,IAAAA,IAAI,EAAE,UADU;AAEhBoC,IAAAA,aAAa,EAAE,IAFC;AAGhBtD,IAAAA,QAAQ,EAAEA,QAHM;AAIhBuD,IAAAA,QAAQ,EAAErD,cAJM;AAKhBsD,IAAAA,WAAW,EAAE5C,iBALG;AAMhB6C,IAAAA,uBAAuB,EAAExC,iBANT;AAOhByC,IAAAA,KAAK,EAAE;AAAEC,MAAAA,eAAe,EAAE;AAAnB;AAPS,GAAlB;AAUA/E,EAAAA,SAAS,CAAC,YAAM;AACdgF,IAAAA,mBAAmB;AACpB,GAFQ,EAEN,EAFM,CAAT;;AAIA,MAAMA,mBAAmB,GAAG,SAAtBA,mBAAsB,GAAM;AAChC,QAAMC,KAAK,GAAG9B,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAd;;AACA,QAAI,CAAC6B,KAAL,EAAY;AACVxD,MAAAA,OAAO,CAACyC,KAAR,CAAc,iCAAd;AACA;AACD;;AAED,QAAMgB,UAAU,GAAGD,KAAK,CAAC5B,IAAN,EAAnB;AACA,QAAM8B,cAAc,GAAGD,UAAU,CAAC5B,OAAX,CAAmB,MAAnB,EAA2B,EAA3B,CAAvB;AAEA7B,IAAAA,OAAO,CAACC,GAAR,CAAY,oCAAZ,EAAkDyD,cAAlD;AAEAnC,IAAAA,KAAK,CAAC,2CAAD,EAA8C;AACjDE,MAAAA,OAAO,EAAE;AACN,0CAA2BiC,cAA3B;AADM;AADwC,KAA9C,CAAL,CAKC5B,IALD,CAKM,UAAAC,QAAQ,EAAI;AAChB,UAAI,CAACA,QAAQ,CAACC,EAAd,EAAkB;AAChB,cAAM,IAAIC,KAAJ,uBAAyBF,QAAQ,CAACG,MAAlC,EAAN;AACD;;AACD,aAAOH,QAAQ,CAACI,IAAT,EAAP;AACD,KAVD,EAWCL,IAXD,CAWM,UAAAM,IAAI,EAAI;AACZpC,MAAAA,OAAO,CAACC,GAAR,CAAY,0BAAZ,EAAwCmC,IAAxC;AACA7C,MAAAA,UAAU,CAAC6C,IAAD,CAAV,CAFY,CAEM;;AAClB3C,MAAAA,eAAe,CAAC2C,IAAI,CAACU,MAAN,CAAf;AACD,KAfD,EAgBCN,KAhBD,CAgBO,UAAAmB,GAAG,EAAI;AACZ3D,MAAAA,OAAO,CAACyC,KAAR,CAAc,yBAAd,EAAyCkB,GAAG,CAACrB,OAA7C;AACD,KAlBD;AAmBD,GA/BD,CAvGsB,CA2ItB;;;AACA,MAAMsB,OAAO,GAAG,CACd;AAAEC,IAAAA,SAAS,EAAE,KAAb;AAAoBC,IAAAA,IAAI,EAAE,IAA1B;AAAgCC,IAAAA,MAAM,EAAE;AAAxC,GADc,EAEd;AAAEF,IAAAA,SAAS,EAAE,KAAb;AAAoBC,IAAAA,IAAI,EAAE;AAA1B,GAFc,EAGd;AAAED,IAAAA,SAAS,EAAE,QAAb;AAAuBC,IAAAA,IAAI,EAAE;AAA7B,GAHc,EAId;AAAED,IAAAA,SAAS,EAAE,OAAb;AAAsBC,IAAAA,IAAI,EAAE;AAA5B,GAJc,EAKd;AACED,IAAAA,SAAS,EAAE,SADb;AAEEC,IAAAA,IAAI,EAAE,SAFR;AAGEE,IAAAA,SAAS,EAAE,mBAACC,WAAD,EAAcnE,GAAd;AAAA,0BACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE,oBAAC,MAAD;AAAQ,QAAA,KAAK,EAAC,SAAd;AAAwB,QAAA,IAAI,EAAC,IAA7B;AAAkC,QAAA,OAAO,EAAE;AAAA,iBAAMoE,aAAa,CAACpE,GAAG,CAACI,GAAL,CAAnB;AAAA,SAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBADF,EAIG,GAJH,eAKE,oBAAC,MAAD;AAAQ,QAAA,KAAK,EAAC,QAAd;AAAuB,QAAA,IAAI,EAAC,IAA5B;AAAiC,QAAA,OAAO,EAAE;AAAA,iBAAMiE,YAAY,CAACrE,GAAG,CAACI,GAAL,CAAlB;AAAA,SAA1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE;AAAG,QAAA,SAAS,EAAC,cAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CALF,CADS;AAAA;AAHb,GALc,CAAhB;;AAuBA,MAAMgE,aAAa,GAAG,SAAhBA,aAAgB,CAAC5C,QAAD,EAAc;AAClC,QAAMkC,KAAK,GAAG9B,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAd;;AACA,QAAI,CAAC6B,KAAL,EAAY;AACVxD,MAAAA,OAAO,CAACyC,KAAR,CAAc,iCAAd;AACA;AACD;;AAED,QAAMgB,UAAU,GAAGD,KAAK,CAAC5B,IAAN,EAAnB;AACA,QAAM8B,cAAc,GAAGD,UAAU,CAAC5B,OAAX,CAAmB,MAAnB,EAA2B,EAA3B,CAAvB;AAEAN,IAAAA,KAAK,qDAA8CD,QAA9C,GAA0D;AAC7DE,MAAAA,MAAM,EAAE,KADqD;AAE7DC,MAAAA,OAAO,EAAE;AACP,0CAA2BiC,cAA3B,CADO;AAEP,wBAAgB;AAFT;AAFoD,KAA1D,CAAL,CAOC5B,IAPD,CAOM,UAAAC,QAAQ,EAAI;AAChB,UAAI,CAACA,QAAQ,CAACC,EAAd,EAAkB;AAChB,cAAM,IAAIC,KAAJ,uBAAyBF,QAAQ,CAACG,MAAlC,EAAN;AACD;;AACD,aAAOH,QAAQ,CAACI,IAAT,EAAP;AACD,KAZD,EAaCL,IAbD,CAaM,UAAAM,IAAI,EAAI;AACZ,UAAIA,IAAI,CAACC,OAAT,EAAkB;AAChB5C,QAAAA,eAAe,CAAC,UAAA8C,SAAS;AAAA,iBAAIA,SAAS,GAAG,CAAhB;AAAA,SAAV,CAAf;AACA9D,QAAAA,KAAK,CAAC4D,OAAN,CAAc,+BAAd;AAEA9C,QAAAA,UAAU,CAAC,UAAA6E,cAAc;AAAA,iBAAIA,cAAc,CAAC/D,MAAf,CAAsB,UAAAsC,MAAM;AAAA,mBAAIA,MAAM,CAACzC,GAAP,KAAeoB,QAAnB;AAAA,WAA5B,CAAJ;AAAA,SAAf,CAAV;AACD,OALD,MAKO;AACL,cAAM,IAAIW,KAAJ,CAAUG,IAAI,CAACE,OAAf,CAAN;AACD;AACF,KAtBD,EAuBCE,KAvBD,CAuBO,UAAAC,KAAK,EAAI;AACdzC,MAAAA,OAAO,CAACyC,KAAR,CAAc,QAAd,EAAwBA,KAAxB;AACAhE,MAAAA,KAAK,CAACgE,KAAN,kBAAsBA,KAAK,CAACH,OAA5B;AACD,KA1BD;AA2BD,GArCD;;AAuCA,MAAM6B,YAAY,GAAG,SAAfA,YAAe,CAAC7C,QAAD,EAAc;AACjC,QAAMkC,KAAK,GAAG9B,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAd;;AACA,QAAI,CAAC6B,KAAL,EAAY;AACVxD,MAAAA,OAAO,CAACyC,KAAR,CAAc,iCAAd;AACA;AACD;;AAED,QAAMgB,UAAU,GAAGD,KAAK,CAAC5B,IAAN,EAAnB;AACA,QAAM8B,cAAc,GAAGD,UAAU,CAAC5B,OAAX,CAAmB,MAAnB,EAA2B,EAA3B,CAAvB;AAEAN,IAAAA,KAAK,uDAAgDD,QAAhD,GAA4D;AAC/DE,MAAAA,MAAM,EAAE,QADuD;AAE/DC,MAAAA,OAAO,EAAE;AACP,0CAA2BiC,cAA3B,CADO;AAEP,wBAAgB;AAFT;AAFsD,KAA5D,CAAL,CAOC5B,IAPD,CAOM,UAAAC,QAAQ,EAAI;AAChB,UAAI,CAACA,QAAQ,CAACC,EAAd,EAAkB;AAChB,cAAM,IAAIC,KAAJ,uBAAyBF,QAAQ,CAACG,MAAlC,EAAN;AACD;;AACD,aAAOH,QAAQ,CAACI,IAAT,EAAP;AACD,KAZD,EAaCL,IAbD,CAaM,UAAAM,IAAI,EAAI;AACZ,UAAIA,IAAI,CAACC,OAAT,EAAkB;AAChB5D,QAAAA,KAAK,CAAC4D,OAAN,CAAc,8BAAd;AACA5C,QAAAA,eAAe,CAAC,UAAA8C,SAAS;AAAA,iBAAIA,SAAS,GAAG,CAAhB;AAAA,SAAV,CAAf;AACAhD,QAAAA,UAAU,CAAC,UAAA6E,cAAc;AAAA,iBAAIA,cAAc,CAAC/D,MAAf,CAAsB,UAAAsC,MAAM;AAAA,mBAAIA,MAAM,CAACzC,GAAP,KAAeoB,QAAnB;AAAA,WAA5B,CAAJ;AAAA,SAAf,CAAV;AACD,OAJD,MAIO;AACL,cAAM,IAAIW,KAAJ,CAAUG,IAAI,CAACE,OAAf,CAAN;AACD;AACF,KArBD,EAsBCE,KAtBD,CAsBO,UAAAC,KAAK,EAAI;AACdzC,MAAAA,OAAO,CAACyC,KAAR,CAAc,QAAd,EAAwBA,KAAxB;AACAhE,MAAAA,KAAK,CAACgE,KAAN,kBAAsBA,KAAK,CAACH,OAA5B;AACD,KAzBD;AA0BH,GApCC;;AAsCA,sBACE,uDACA,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADA,eAEA,oBAAC,SAAD;AAAW,IAAA,SAAS,EAAC,OAArB;AAA6B,IAAA,KAAK,MAAlC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI,oBAAC,cAAD;AAAgB,IAAA,QAAQ,EAAC,cAAzB;AAAwC,IAAA,SAAS,EAAE,IAAnD;AAAyD,IAAA,eAAe,EAAE,KAA1E;AAAiF,IAAA,WAAW,EAAE,KAA9F;AAAqG,IAAA,YAAY,MAAjH;AAAkH,IAAA,GAAG,EAAE,KAAvH;AAA8H,IAAA,gBAAgB,MAA9I;AAA+I,IAAA,SAAS,MAAxJ;AAAyJ,IAAA,YAAY,MAArK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,eAEE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,IAAD;AAAM,IAAA,SAAS,EAAC,QAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,UAAD;AAAY,IAAA,SAAS,EAAC,UAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAI,IAAA,SAAS,EAAC,MAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BAAyC9C,YAAzC,MADF,CADF,eAIE,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACA,oBAAC,eAAD;AACV,IAAA,QAAQ,EAAC,KADC;AAEV,IAAA,IAAI,EAAEF,OAFI;AAGV,IAAA,OAAO,EAAEsE,OAHC;AAIV,IAAA,MAAM,MAJI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAQM,UAAAS,KAAK;AAAA,wBACH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGxB,YADH,eAEE,oBAAC,SAAD,oBAAewB,KAAK,CAACC,WAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAFF,eAGE,oBAAC,cAAD,oBACMD,KAAK,CAACE,SADZ;AAEE,MAAA,UAAU,MAFZ;AAGE,MAAA,UAAU,EAAEtF,iBAAiB,EAH/B;AAIE,MAAA,gBAAgB,EAAC,oCAJnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAHF,CADG;AAAA,GARX,CADA,CAJF,CADF,CADF,CAFF,CAFA,CADF;AAyCD,CAzRD;;GAAMI,S;;KAAAA,S;AA2RN,eAAeA,SAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { ToastContainer, toast } from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\n\r\nimport {\r\n  Button,\r\n  CardBody,\r\n  Card,\r\n  CardHeader,\r\n  Container,\r\n  Row,\r\n} from \"reactstrap\";\r\nimport BootstrapTable from \"react-bootstrap-table-next\";\r\nimport paginationFactory from \"react-bootstrap-table2-paginator\";\r\nimport ToolkitProvider, { Search } from \"react-bootstrap-table2-toolkit\";\r\nimport Header from \"components/Headers/Header.js\";\r\nimport 'react-bootstrap-table-next/dist/react-bootstrap-table2.min.css';\r\n\r\n\r\nconst Corbeille = () => {\r\n  const [clients, setClients] = useState([]);\r\n  const [totalClients, setTotalClients] = useState(0);\r\n  const { SearchBar } = Search;\r\n  const [selected, setSelected] = useState([]);\r\n\r\n  const handleOnSelect = (row, isSelect) => {\r\n    console.log(`Select ${isSelect ? 'on' : 'off'} for row id ${row._id}`);\r\n    if (isSelect) {\r\n      setSelected(prevSelected => {\r\n        const newSelected = [...prevSelected, row._id];\r\n        console.log('New selected after add:', newSelected);\r\n        return newSelected;\r\n      });\r\n    } else {\r\n      setSelected(prevSelected => {\r\n        const newSelected = prevSelected.filter(x => x !== row._id);\r\n        console.log('New selected after remove:', newSelected);\r\n        return newSelected;\r\n      });\r\n    }\r\n  };\r\n  \r\n  const handleOnSelectAll = (isSelect, rows) => {\r\n    console.log(`Select all ${isSelect ? 'on' : 'off'}`);\r\n    if (isSelect) {\r\n      const idsToSelect = rows.map(r => r._id);\r\n      console.log('Selecting all ids:', idsToSelect);\r\n      setSelected(idsToSelect);\r\n    } else {\r\n      setSelected([]);\r\n    }\r\n  };\r\n  \r\n  \r\n  const selectAllRenderer = ({ mode, checked, indeterminate }) => (\r\n    <input\r\n      type={mode}\r\n      checked={checked}\r\n      ref={input => {\r\n        if (input) input.indeterminate = indeterminate;\r\n      }}\r\n      onChange={e => {\r\n        handleOnSelectAll(e.target.checked, clients);  // Appelez handleOnSelectAll avec le bon contexte\r\n      }}\r\n    />\r\n  );\r\n  \r\n  const handleDeleteSelected = async () => {\r\n    if (window.confirm(\"Êtes-vous sûr de vouloir supprimer les clients sélectionnés ?\")) {\r\n      for (const clientId of selected) {\r\n        await fetch(`http://localhost:5100/api/clients/${clientId}`, {\r\n          method: 'DELETE',\r\n          headers: {\r\n            'Authorization': `Bearer ${localStorage.getItem('token').trim().replace('JWT ', '')}`\r\n          }\r\n        })\r\n        .then(response => {\r\n          if (!response.ok) {\r\n            throw new Error(`Failed to delete client ${clientId}, status: ${response.status}`);\r\n          }\r\n          return response.json();\r\n        })\r\n        .then(data => {\r\n          if (!data.success) {\r\n            throw new Error(data.message);\r\n          }\r\n          setTotalClients(prevTotal => prevTotal - 1);\r\n          toast.success(`Client supprimé avec succès!`);\r\n        })\r\n        .catch(error => {\r\n          console.error('Error:', error);\r\n          toast.error(`Error deleting client ${clientId}: ${error.message}`);\r\n        });\r\n      }\r\n      // Mise à jour de l'état après la suppression de tous les clients sélectionnés\r\n      const newClients = clients.filter(client => !selected.includes(client._id));\r\n      setClients(newClients);\r\n      setSelected([]);\r\n    }\r\n  };\r\n  \r\n  \r\n  const deleteButton = selected.length > 0 ? (\r\n    <Button color=\"danger\" onClick={handleDeleteSelected} style={{ marginLeft: '10px' }}>\r\n      Supprimer la sélection\r\n    </Button>\r\n  ) : null;\r\n  \r\n  const selectRow = {\r\n    mode: 'checkbox',\r\n    clickToSelect: true,\r\n    selected: selected,\r\n    onSelect: handleOnSelect,\r\n    onSelectAll: handleOnSelectAll,\r\n    selectionHeaderRenderer: selectAllRenderer,\r\n    style: { backgroundColor: '#c8e6c9' }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchDeletedClients();\r\n  }, []);\r\n\r\n  const fetchDeletedClients = () => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) {\r\n      console.error('Token not found in localStorage');\r\n      return;\r\n    }\r\n  \r\n    const cleanToken = token.trim();\r\n    const formattedToken = cleanToken.replace('JWT ', '');\r\n  \r\n    console.log(\"Formatted Token from localStorage:\", formattedToken);\r\n  \r\n    fetch('http://localhost:5100/api/clients/deleted', {\r\n      headers: {\r\n         'Authorization': `Bearer ${formattedToken}`\r\n      }\r\n    })\r\n    .then(response => {\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP status ${response.status}`);\r\n      }\r\n      return response.json();\r\n    })\r\n    .then(data => {\r\n      console.log('Deleted clients fetched:', data);\r\n      setClients(data); // Ceci met à jour l'état avec les données récupérées\r\n      setTotalClients(data.length);\r\n    })\r\n    .catch(err => {\r\n      console.error('Error fetching clients:', err.message);\r\n    });\r\n  };\r\n  \r\n  \r\n  \r\n\r\n  // Définition des colonnes du tableau\r\n  const columns = [\r\n    { dataField: \"_id\", text: \"ID\", hidden: true },\r\n    { dataField: \"nom\", text: \"Nom\" },\r\n    { dataField: \"prenom\", text: \"Prénom\" },\r\n    { dataField: \"email\", text: \"Email\" },\r\n    {\r\n      dataField: \"actions\",\r\n      text: \"Actions\",\r\n      formatter: (cellContent, row) => (\r\n        <div>\r\n          <Button color=\"success\" size=\"sm\" onClick={() => restoreClient(row._id)}>\r\n            Restaurer\r\n          </Button>\r\n          {' '}\r\n          <Button color=\"danger\" size=\"sm\" onClick={() => deleteClient(row._id)}>\r\n            <i className=\"fas fa-trash\"></i>\r\n          </Button>\r\n        </div>\r\n      )\r\n    }\r\n];\r\n\r\n\r\n  const restoreClient = (clientId) => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) {\r\n      console.error('Token not found in localStorage');\r\n      return;\r\n    }\r\n  \r\n    const cleanToken = token.trim();\r\n    const formattedToken = cleanToken.replace('JWT ', '');\r\n  \r\n    fetch(`http://localhost:5100/api/clients/restore/${clientId}`, {\r\n      method: 'PUT',\r\n      headers: {\r\n        'Authorization': `Bearer ${formattedToken}`,\r\n        'Content-Type': 'application/json'\r\n      }\r\n    })\r\n    .then(response => {\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP status ${response.status}`);\r\n      }\r\n      return response.json();\r\n    })\r\n    .then(data => {\r\n      if (data.success) {\r\n        setTotalClients(prevTotal => prevTotal - 1);\r\n        toast.success(\"Client restauré avec succés !\");\r\n        \r\n        setClients(currentClients => currentClients.filter(client => client._id !== clientId));\r\n      } else {\r\n        throw new Error(data.message);\r\n      }\r\n    })\r\n    .catch(error => {\r\n      console.error('Error:', error);\r\n      toast.error(`Error: ${error.message}`);\r\n    });\r\n  };\r\n  \r\n  const deleteClient = (clientId) => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) {\r\n      console.error('Token not found in localStorage');\r\n      return;\r\n    }\r\n  \r\n    const cleanToken = token.trim();\r\n    const formattedToken = cleanToken.replace('JWT ', '');\r\n  \r\n    fetch(`http://localhost:5100/api/clients/deletedef/${clientId}`, {\r\n      method: 'DELETE',\r\n      headers: {\r\n        'Authorization': `Bearer ${formattedToken}`,\r\n        'Content-Type': 'application/json'\r\n      }\r\n    })\r\n    .then(response => {\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP status ${response.status}`);\r\n      }\r\n      return response.json();\r\n    })\r\n    .then(data => {\r\n      if (data.success) {\r\n        toast.success(\"Client supprimé avec succès!\");\r\n        setTotalClients(prevTotal => prevTotal - 1);\r\n        setClients(currentClients => currentClients.filter(client => client._id !== clientId));\r\n      } else {\r\n        throw new Error(data.message);\r\n      }\r\n    })\r\n    .catch(error => {\r\n      console.error('Error:', error);\r\n      toast.error(`Error: ${error.message}`);\r\n    });\r\n};\r\n\r\n  return (\r\n    <>\r\n    <Header/> \r\n    <Container className=\"mt--7\" fluid>\r\n        <ToastContainer position=\"bottom-right\" autoClose={5000} hideProgressBar={false} newestOnTop={false} closeOnClick rtl={false} pauseOnFocusLoss draggable pauseOnHover />\r\n      <Row>\r\n        <div className=\"col\">\r\n          <Card className=\"shadow\">\r\n            <CardHeader className=\"border-0\">\r\n              <h3 className=\"mb-0\">Corbeille (Total : {totalClients})</h3>\r\n            </CardHeader>\r\n            <CardBody>\r\n            <ToolkitProvider\r\n  keyField=\"_id\"\r\n  data={clients}\r\n  columns={columns}\r\n  search\r\n>\r\n\r\n                {\r\n                  props => (\r\n                    <div>\r\n                      {deleteButton}\r\n                      <SearchBar {...props.searchProps} />\r\n                      <BootstrapTable\r\n                        {...props.baseProps}\r\n                        bootstrap4\r\n                        pagination={paginationFactory()}\r\n                        noDataIndication=\"Aucun client supprimé trouvé\"\r\n                      />\r\n                    </div>\r\n                  )\r\n                }\r\n              </ToolkitProvider>\r\n            </CardBody>\r\n          </Card>\r\n        </div>\r\n      </Row>\r\n    </Container>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Corbeille;\r\n"]},"metadata":{},"sourceType":"module"}