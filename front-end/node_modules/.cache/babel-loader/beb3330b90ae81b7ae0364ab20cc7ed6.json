{"ast":null,"code":"import _slicedToArray from \"C:/Users/user/Desktop/Projet Code/Ouieqare-MERN - Copie/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\user\\\\Desktop\\\\Projet Code\\\\Ouieqare-MERN - Copie\\\\front-end\\\\src\\\\views\\\\examples\\\\Clients.js\",\n    _s = $RefreshSig$();\n\nimport { useHistory } from \"react-router-dom\";\nimport React, { useState, useRef, useEffect } from \"react\";\nimport { Button //ButtonGroup,\n, CardBody, Card //Col,\n, CardHeader, Container, Row } from \"reactstrap\"; //import ReactToPrint from \"react-to-print\";\n\nimport BootstrapTable from \"react-bootstrap-table-next\";\nimport paginationFactory from \"react-bootstrap-table2-paginator\";\nimport ToolkitProvider, { Search } from \"react-bootstrap-table2-toolkit\"; //import ReactBSAlert from \"react-bootstrap-sweetalert\";\n\nimport Header from \"components/Headers/Header.js\"; //import { dataTable } from \"variables/general\";\n\nvar formatDate = function formatDate(isoString) {\n  if (!isoString) return '';\n  var date = new Date(isoString);\n  return date.toLocaleDateString('fr-FR'); // ou 'en-US' selon le format local que vous préférez\n};\n\nvar fetchClients = function fetchClients(setClients) {\n  // Pass setClients as a parameter\n  var token = localStorage.getItem('token');\n\n  if (!token) {\n    console.error('Token not found in localStorage');\n    return;\n  }\n\n  var cleanToken = token.trim();\n  var formattedToken = cleanToken.replace('JWT ', '');\n  console.log(\"Formatted Token from localStorage:\", formattedToken);\n  fetch('http://localhost:5100/api/clients', {\n    headers: {\n      'Authorization': \"Bearer \".concat(formattedToken)\n    }\n  }).then(function (response) {\n    if (!response.ok) {\n      throw new Error(\"HTTP status \".concat(response.status));\n    }\n\n    return response.json();\n  }).then(function (data) {\n    console.log('Clients fetched:', data);\n    setClients(data); // Ensure this line is uncommented and correctly used\n  }).catch(function (err) {\n    console.error('Error fetching clients:', err.message);\n  });\n};\n\nvar Tables = function Tables() {\n  _s();\n\n  //const [modal, setModal] = useState(false);\n  //const toggleModal = () => setModal(!modal);\n  var history = useHistory();\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      clients = _useState2[0],\n      setClients = _useState2[1];\n\n  var componentRef = useRef(null);\n  var inputFileRef = useRef(null);\n\n  var handleAddClient = function handleAddClient() {\n    console.log('Redirection to /admin/nouveauClient');\n    history.push('/admin/nouveauClient');\n  };\n\n  var columns = [{\n    dataField: \"id\",\n    text: \"ID\",\n    hidden: true\n  }, {\n    dataField: \"nom\",\n    text: \"Nom\"\n  }, {\n    dataField: \"prenom\",\n    text: \"Prénom\"\n  }, {\n    dataField: \"email\",\n    text: \"Email\"\n  }, {\n    dataField: \"telephonePortable\",\n    text: \"Téléphone Portable\"\n  }, {\n    dataField: \"ville\",\n    text: \"Ville\"\n  }, {\n    dataField: \"dateNaissance\",\n    text: \"Date de Naissance\",\n    formatter: function formatter(cellContent, row) {\n      return formatDate(row.dateNaissance); // Formate la date avant de l'afficher\n    }\n  }, {\n    dataField: 'actions',\n    text: 'Actions',\n    formatter: function formatter(cell, row) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        color: \"primary\",\n        size: \"sm\",\n        onClick: function onClick() {\n          return handleEditClient(row);\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fas fa-pencil-alt\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 15\n        }\n      })), ' ', /*#__PURE__*/React.createElement(Button, {\n        color: \"danger\",\n        size: \"sm\",\n        onClick: function onClick() {\n          return handleDeleteClient(row._id);\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fas fa-trash\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 15\n        }\n      })));\n    }\n  }]; // Fonction pour gérer la modification des clients\n\n  var handleEditClient = function handleEditClient(client) {\n    history.push({\n      pathname: '/admin/nouveauClient',\n      state: {\n        client: client\n      }\n    });\n  }; // Fonction pour gérer la suppression des clients\n\n\n  var handleDeleteClient = function handleDeleteClient(clientId) {\n    if (window.confirm(\"Êtes-vous sûr de vouloir supprimer ce client ?\")) {\n      fetch(\"http://localhost:5100/api/clients/\".concat(clientId), {\n        method: 'DELETE',\n        headers: {\n          'Authorization': \"Bearer \".concat(localStorage.getItem('token').trim().replace('JWT ', ''))\n        }\n      }).then(function (response) {\n        if (!response.ok) {\n          throw new Error('Failed to delete client');\n        }\n\n        return response.json(); // Assurez-vous que le serveur renvoie une réponse JSON\n      }).then(function (data) {\n        if (data.success) {\n          setClients(function (prevClients) {\n            return prevClients.filter(function (client) {\n              return client._id !== clientId;\n            });\n          }); // ou utilisez une autre méthode de mise à jour de l'état si vous utilisez un autre état global comme Redux\n        } else {\n          console.error('Failed to delete client:', data.message);\n        }\n      }).catch(function (error) {\n        return console.error('Error:', error);\n      });\n    }\n  }; // const handleFileUpload = (event) => {\n  //   const file = event.target.files[0];\n  //   if (file) {\n  //     const reader = new FileReader();\n  //     reader.onload = (e) => {\n  //       const text = e.target.result;\n  //       // Convertir CSV en JSON ici ou envoyer le texte brut au serveur pour traitement\n  //       uploadData(text);\n  //     };\n  //     reader.readAsText(file);\n  //   }\n  // };\n  // const uploadData = (data) => {\n  //   fetch('http://localhost:5100/api/clients/import', {\n  //     method: 'POST',\n  //     headers: {\n  //       'Content-Type': 'application/json',\n  //       'Authorization': `Bearer ${localStorage.getItem('token').trim().replace('JWT ', '')}`\n  //     },\n  //     body: JSON.stringify({ data })\n  //   })\n  //   .then(response => response.json())\n  //   .then(data => {\n  //     console.log(\"Import success:\", data);\n  //     fetchClients(setClients);  // Rafraîchir la liste des clients après l'import\n  //   })\n  //   .catch(err => console.error(\"Import error:\", err));\n  // };\n  // // Ajouter un bouton et input dans le JSX\n\n\n  var handleFileUpload = function handleFileUpload(event) {\n    var file = event.target.files[0];\n    if (!file) return;\n    var formData = new FormData();\n    formData.append('file', file);\n    fetch('http://localhost:5100/api/clients/import', {\n      method: 'POST',\n      headers: {\n        'Authorization': \"Bearer \".concat(localStorage.getItem('token').trim().replace('JWT ', ''))\n      },\n      body: formData\n    }).then(function (response) {\n      return response.json();\n    }).then(function (data) {\n      console.log(\"Import success:\", data);\n      fetchClients(setClients); // Refresh the client list after import\n    }).catch(function (err) {\n      return console.error(\"Import error:\", err);\n    });\n  };\n\n  var pagination = paginationFactory({\n    page: 1,\n    alwaysShowAllBtns: true,\n    //showTotal: true,\n    withFirstAndLast: false,\n    sizePerPageRenderer: function sizePerPageRenderer(_ref) {\n      var options = _ref.options,\n          currSizePerPage = _ref.currSizePerPage,\n          onSizePerPageChange = _ref.onSizePerPageChange;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"dataTables_length\",\n        id: \"datatable-basic_length\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205,\n          columnNumber: 9\n        }\n      }, \" \", /*#__PURE__*/React.createElement(\"select\", {\n        name: \"datatable-basic_length\",\n        \"aria-controls\": \"datatable-basic\",\n        className: \"form-control form-control-sm\",\n        onChange: function onChange(e) {\n          return onSizePerPageChange(e.target.value);\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"option\", {\n        value: \"10\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 15\n        }\n      }, \"10\"), /*#__PURE__*/React.createElement(\"option\", {\n        value: \"25\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 15\n        }\n      }, \"25\"), /*#__PURE__*/React.createElement(\"option\", {\n        value: \"50\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 15\n        }\n      }, \"50\"), /*#__PURE__*/React.createElement(\"option\", {\n        value: \"100\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 15\n        }\n      }, \"100\")), \" \"));\n    }\n  });\n  var SearchBar = Search.SearchBar;\n  useEffect(function () {\n    fetchClients(setClients); // Pass setClients here\n  }, []);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Header, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Container, {\n    className: \"mt--7\",\n    fluid: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Card, {\n    className: \"shadow\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(CardHeader, {\n    className: \"border-0 d-flex align-items-center justify-content-between\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    className: \"mb-0\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 17\n    }\n  }, \"Clients\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"file\",\n    onChange: handleFileUpload,\n    accept: \".csv\",\n    style: {\n      display: 'none'\n    },\n    ref: inputFileRef,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    color: \"info\",\n    onClick: function onClick() {\n      return inputFileRef.current && inputFileRef.current.click();\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 1\n    }\n  }, \"Importer Clients\"), /*#__PURE__*/React.createElement(Button, {\n    color: \"primary\",\n    onClick: handleAddClient,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 17\n    }\n  }, \"Ajouter Client\")), /*#__PURE__*/React.createElement(CardBody, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(ToolkitProvider, {\n    keyField: \"id\",\n    data: clients,\n    columns: columns,\n    search: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 17\n    }\n  }, function (props) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(SearchBar, Object.assign({}, props.searchProps, {\n      style: {\n        border: '1px solid black'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 23\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        overflowX: 'auto'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(BootstrapTable, Object.assign({}, props.baseProps, {\n      ref: componentRef,\n      bootstrap4: true,\n      pagination: pagination,\n      bordered: false,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 25\n      }\n    }))));\n  })))))));\n};\n\n_s(Tables, \"OfdsFXhTHcTs7nknvIt53miVsTo=\", false, function () {\n  return [useHistory];\n});\n\n_c = Tables;\nexport default Tables;\n\nvar _c;\n\n$RefreshReg$(_c, \"Tables\");","map":{"version":3,"sources":["C:/Users/user/Desktop/Projet Code/Ouieqare-MERN - Copie/front-end/src/views/examples/Clients.js"],"names":["useHistory","React","useState","useRef","useEffect","Button","CardBody","Card","CardHeader","Container","Row","BootstrapTable","paginationFactory","ToolkitProvider","Search","Header","formatDate","isoString","date","Date","toLocaleDateString","fetchClients","setClients","token","localStorage","getItem","console","error","cleanToken","trim","formattedToken","replace","log","fetch","headers","then","response","ok","Error","status","json","data","catch","err","message","Tables","history","clients","componentRef","inputFileRef","handleAddClient","push","columns","dataField","text","hidden","formatter","cellContent","row","dateNaissance","cell","handleEditClient","handleDeleteClient","_id","client","pathname","state","clientId","window","confirm","method","success","prevClients","filter","handleFileUpload","event","file","target","files","formData","FormData","append","body","pagination","page","alwaysShowAllBtns","withFirstAndLast","sizePerPageRenderer","options","currSizePerPage","onSizePerPageChange","e","value","SearchBar","display","current","click","props","searchProps","border","overflowX","baseProps"],"mappings":"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","sourcesContent":["import { useHistory } from \"react-router-dom\";\r\nimport React, { useState, useRef, useEffect } from \"react\";\r\nimport {\r\n  Button,\r\n  //ButtonGroup,\r\n  CardBody,\r\n  Card,\r\n  //Col,\r\n  CardHeader,\r\n  Container,\r\n  Row,\r\n} from \"reactstrap\";\r\n//import ReactToPrint from \"react-to-print\";\r\nimport BootstrapTable from \"react-bootstrap-table-next\";\r\nimport paginationFactory from \"react-bootstrap-table2-paginator\";\r\nimport ToolkitProvider, { Search } from \"react-bootstrap-table2-toolkit\";\r\n//import ReactBSAlert from \"react-bootstrap-sweetalert\";\r\nimport Header from \"components/Headers/Header.js\";\r\n//import { dataTable } from \"variables/general\";\r\n\r\nconst formatDate = (isoString) => {\r\n  if (!isoString) return '';\r\n  const date = new Date(isoString);\r\n  return date.toLocaleDateString('fr-FR');  // ou 'en-US' selon le format local que vous préférez\r\n}\r\n\r\n\r\nconst fetchClients = (setClients) => { // Pass setClients as a parameter\r\n  const token = localStorage.getItem('token');\r\n  if (!token) {\r\n      console.error('Token not found in localStorage');\r\n      return;\r\n  }\r\n\r\n  const cleanToken = token.trim();\r\n  const formattedToken = cleanToken.replace('JWT ', '');\r\n\r\n  console.log(\"Formatted Token from localStorage:\", formattedToken);\r\n\r\n  fetch('http://localhost:5100/api/clients', {\r\n      headers: {\r\n          'Authorization': `Bearer ${formattedToken}`\r\n      }\r\n  })\r\n  .then(response => {\r\n      if (!response.ok) {\r\n          throw new Error(`HTTP status ${response.status}`);\r\n      }\r\n      return response.json();\r\n  })\r\n  .then(data => {\r\n      console.log('Clients fetched:', data);\r\n      setClients(data); // Ensure this line is uncommented and correctly used\r\n  })\r\n  .catch(err => {\r\n      console.error('Error fetching clients:', err.message);\r\n  });\r\n};\r\n\r\n\r\nconst Tables = () => {\r\n  //const [modal, setModal] = useState(false);\r\n  //const toggleModal = () => setModal(!modal);\r\n  const history = useHistory();\r\n  const [clients, setClients] = useState([]);\r\n  const componentRef = useRef(null);\r\n  const inputFileRef = useRef(null);\r\n\r\n\r\n  \r\nconst handleAddClient = () => {\r\n  console.log('Redirection to /admin/nouveauClient');\r\n    history.push('/admin/nouveauClient');\r\n  };\r\n\r\n  const columns = [\r\n    { dataField: \"id\", text: \"ID\", hidden: true },\r\n    { dataField: \"nom\", text: \"Nom\" },\r\n    { dataField: \"prenom\", text: \"Prénom\" },\r\n    { dataField: \"email\", text: \"Email\" },\r\n    { dataField: \"telephonePortable\", text: \"Téléphone Portable\" },\r\n    { dataField: \"ville\", text: \"Ville\" },\r\n    {\r\n      dataField: \"dateNaissance\",\r\n      text: \"Date de Naissance\",\r\n      formatter: (cellContent, row) => {\r\n        return formatDate(row.dateNaissance);  // Formate la date avant de l'afficher\r\n      }\r\n    },\r\n    {\r\n      dataField: 'actions',\r\n      text: 'Actions',\r\n      formatter: (cell, row) => {\r\n        return (\r\n          <div>\r\n            <Button color=\"primary\" size=\"sm\" onClick={() => handleEditClient(row)}>\r\n              <i className=\"fas fa-pencil-alt\" />\r\n            </Button>\r\n            {' '}\r\n            <Button color=\"danger\" size=\"sm\" onClick={() => handleDeleteClient(row._id)}>\r\n              <i className=\"fas fa-trash\" />\r\n            </Button>\r\n          </div>\r\n        );\r\n      }\r\n    }\r\n  ];\r\n  \r\n  // Fonction pour gérer la modification des clients\r\n  const handleEditClient = (client) => {\r\n    history.push({\r\n      pathname: '/admin/nouveauClient',\r\n      state: { client: client }\r\n    });\r\n  };\r\n  \r\n  // Fonction pour gérer la suppression des clients\r\n  const handleDeleteClient = (clientId) => {\r\n    if (window.confirm(\"Êtes-vous sûr de vouloir supprimer ce client ?\")) {\r\n      fetch(`http://localhost:5100/api/clients/${clientId}`, {\r\n        method: 'DELETE',\r\n        headers: {\r\n          'Authorization': `Bearer ${localStorage.getItem('token').trim().replace('JWT ', '')}`\r\n        }\r\n      })\r\n      .then(response => {\r\n        if (!response.ok) {\r\n          throw new Error('Failed to delete client');\r\n        }\r\n        return response.json();  // Assurez-vous que le serveur renvoie une réponse JSON\r\n      })\r\n      .then(data => {\r\n        if (data.success) {\r\n          setClients(prevClients => prevClients.filter(client => client._id !== clientId));\r\n          // ou utilisez une autre méthode de mise à jour de l'état si vous utilisez un autre état global comme Redux\r\n        } else {\r\n          console.error('Failed to delete client:', data.message);\r\n        }\r\n      })\r\n      .catch(error => console.error('Error:', error));\r\n    }\r\n  };\r\n\r\n  // const handleFileUpload = (event) => {\r\n  //   const file = event.target.files[0];\r\n  //   if (file) {\r\n  //     const reader = new FileReader();\r\n  //     reader.onload = (e) => {\r\n  //       const text = e.target.result;\r\n  //       // Convertir CSV en JSON ici ou envoyer le texte brut au serveur pour traitement\r\n  //       uploadData(text);\r\n  //     };\r\n  //     reader.readAsText(file);\r\n  //   }\r\n  // };\r\n  \r\n  // const uploadData = (data) => {\r\n  //   fetch('http://localhost:5100/api/clients/import', {\r\n  //     method: 'POST',\r\n  //     headers: {\r\n  //       'Content-Type': 'application/json',\r\n  //       'Authorization': `Bearer ${localStorage.getItem('token').trim().replace('JWT ', '')}`\r\n  //     },\r\n  //     body: JSON.stringify({ data })\r\n  //   })\r\n  //   .then(response => response.json())\r\n  //   .then(data => {\r\n  //     console.log(\"Import success:\", data);\r\n  //     fetchClients(setClients);  // Rafraîchir la liste des clients après l'import\r\n  //   })\r\n  //   .catch(err => console.error(\"Import error:\", err));\r\n  // };\r\n  \r\n  // // Ajouter un bouton et input dans le JSX\r\n  \r\n  const handleFileUpload = (event) => {\r\n    const file = event.target.files[0];\r\n    if (!file) return;\r\n\r\n    const formData = new FormData();\r\n    formData.append('file', file);\r\n\r\n    fetch('http://localhost:5100/api/clients/import', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${localStorage.getItem('token').trim().replace('JWT ', '')}`\r\n        },\r\n        body: formData\r\n    })\r\n    .then(response => response.json())\r\n    .then(data => {\r\n        console.log(\"Import success:\", data);\r\n        fetchClients(setClients);  // Refresh the client list after import\r\n    })\r\n    .catch(err => console.error(\"Import error:\", err));\r\n};\r\n\r\n  const pagination = paginationFactory({\r\n    page: 1,\r\n    alwaysShowAllBtns: true,\r\n    //showTotal: true,\r\n    withFirstAndLast: false,\r\n    sizePerPageRenderer: ({ options, currSizePerPage, onSizePerPageChange }) => (\r\n      <div className=\"dataTables_length\" id=\"datatable-basic_length\">\r\n        <label>\r\n          {\" \"}\r\n          {\r\n            <select\r\n              name=\"datatable-basic_length\"\r\n              aria-controls=\"datatable-basic\"\r\n              className=\"form-control form-control-sm\"\r\n              onChange={e => onSizePerPageChange(e.target.value)}\r\n            >\r\n              <option value=\"10\">10</option>\r\n              <option value=\"25\">25</option>\r\n              <option value=\"50\">50</option>\r\n              <option value=\"100\">100</option>\r\n            </select>\r\n          }{\" \"}\r\n          \r\n        </label>\r\n      </div>\r\n    )\r\n  });\r\n\r\n  const { SearchBar } = Search;\r\n  useEffect(() => {\r\n    fetchClients(setClients); // Pass setClients here\r\n}, []); \r\n\r\n\r\n  return (\r\n    <>\r\n      <Header />\r\n      <Container className=\"mt--7\" fluid>\r\n        <Row>\r\n          <div className=\"col\">\r\n            <Card className=\"shadow\">\r\n              <CardHeader className=\"border-0 d-flex align-items-center justify-content-between\">\r\n                <h3 className=\"mb-0\">Clients</h3>\r\n                <input type=\"file\" onChange={handleFileUpload} accept=\".csv\" style={{ display: 'none' }} ref={inputFileRef} />\r\n<Button color=\"info\" onClick={() => inputFileRef.current && inputFileRef.current.click()}>\r\n  Importer Clients\r\n</Button>\r\n                {/* <Button color=\"primary\" onClick={toggleModal}>Ajouter Client</Button> */}\r\n                <Button color=\"primary\" onClick={handleAddClient}>Ajouter Client</Button>\r\n              </CardHeader>\r\n              \r\n              <CardBody>\r\n                \r\n                <ToolkitProvider\r\n                  keyField=\"id\"\r\n                  data={clients}\r\n                  columns={columns}\r\n                  search\r\n                >\r\n                  {props => (\r\n                    <div>\r\n                      \r\n                      <SearchBar {...props.searchProps} style={{ border: '1px solid black' }} />\r\n                      <div style={{ overflowX: 'auto' }}>\r\n                        <BootstrapTable\r\n                          {...props.baseProps}\r\n                          ref={componentRef}\r\n                          bootstrap4\r\n                          pagination={pagination}\r\n                          bordered={false}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </ToolkitProvider>\r\n              </CardBody>\r\n            </Card>\r\n          </div>\r\n        </Row>\r\n      </Container>\r\n      {/* <AddClientModal isOpen={modal} toggle={toggleModal} onSave={addNewClient} /> */}\r\n    </>\r\n  );\r\n};\r\n\r\n\r\n\r\nexport default Tables;\r\n"]},"metadata":{},"sourceType":"module"}